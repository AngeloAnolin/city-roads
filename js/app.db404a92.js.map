{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/proto/place.js","webpack:///./src/components/FindPlace.vue?e88a","webpack:///./src/App.vue?876c","webpack:///./src/components/FindPlace.vue?2a72","webpack:///./src/components/LoadingIcon.vue?4e08","webpack:///./src/components/LoadingIcon.vue","webpack:///./src/lib/Progress.js","webpack:///./src/lib/request.js","webpack:///./src/lib/postData.js","webpack:///./src/lib/BoundingBox.js","webpack:///./src/lib/Grid.js","webpack:///./src/lib/findBoundaryByName.js","webpack:///./src/lib/Query.js","webpack:///./src/lib/appState.js","webpack:///./src/config.js","webpack:///./src/lib/LoadOptions.js","webpack:///src/components/FindPlace.vue","webpack:///./src/components/FindPlace.vue?e4fa","webpack:///./src/components/clickOutside.js","webpack:///./src/components/FindPlace.vue","webpack:///./src/components/EditableLabel.vue?a8a2","webpack:///src/components/EditableLabel.vue","webpack:///./src/components/EditableLabel.vue?a493","webpack:///./src/components/EditableLabel.vue","webpack:///./src/components/ColorPicker.vue?cf6b","webpack:///src/components/ColorPicker.vue","webpack:///./src/components/ColorPicker.vue?bb49","webpack:///./src/components/ColorPicker.vue","webpack:///./src/lib/bus.js","webpack:///./src/lib/GridLayer.js","webpack:///./src/lib/svgExport.js","webpack:///./src/lib/saveFile.js","webpack:///./src/lib/createScene.js","webpack:///./src/lib/getZazzleLink.js","webpack:///./src/createOverlayManager.js","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/NoWebGL.vue?136b","webpack:///./src/NoWebGL.vue","webpack:///./src/main.js","webpack:///./src/App.vue?995e","webpack:///./src/lib/protobufExport.js","webpack:///./src/lib/canvas2BlobPolyfill.js","webpack:///./src/components/EditableLabel.vue?b644","webpack:///./src/NoWebGL.vue?2a71","webpack:///./src/components/ColorPicker.vue?f0b2"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","place","read","pbf","end","readFields","_readField","version","date","id","nodes","ways","tag","obj","readVarint","readString","node","pos","way","write","writeVarintField","writeStringField","writeMessage","lat","lon","readFloat","writeFloatField","readPackedVarint","writePackedVarint","_vm","this","_h","$createElement","_c","_self","placeFound","_e","on","onGridLoaded","attrs","staticClass","$event","preventDefault","toggleSettings","_v","startOver","_l","layer","changeColor","model","callback","$$v","$set","expression","_s","zazzleMugPrint","_m","zazzleLink","generatingPreview","toPNGFile","toSVGFile","style","color","labelColorRGBA","overlayManager","staticRenderFns","class","centered","boxInTheMiddle","onSubmit","directives","rawName","ref","domProps","target","composing","enteredInput","hideInput","mainActionText","loading","suggestionsLoaded","suggestions","suggestion","index","pickSuggestion","type","error","retry","getBugReportURL","cancelRequest","stillLoading","script","component","Progress","notify","eventify","Function","isCancelled","fire","progress","off","request","url","options","req","onCancel","cancelDownload","Promise","download","abort","resolve","reject","updateProgress","e","lengthComputable","loaded","total","percent","transferComplete","offCancel","status","response","responseType","JSON","parse","setTimeout","statusError","message","transferFailed","transferCanceled","cancelled","XMLHttpRequest","addEventListener","open","method","headers","keys","forEach","setRequestHeader","send","body","backends","postData","encodeURIComponent","serverIndex","fetchFrom","overpassUrl","catch","handleError","err","BBox","minX","Infinity","minY","maxX","maxY","offset","xIn","yIn","undefined","Error","x","y","rect","addPoint","left","top","right","bottom","otherBBox","Grid","elements","bounds","BoundingBox","Map","wayPointCount","isArea","projector","bboxString","newProjector","project","getProjector","leftTop","rightBottom","width","height","Math","abs","enter","exit","positions","element","nodeIds","last","next","q","geoMercator","center","cx","cy","scale","xyPoint","elementsOfOSMResponse","grid","fromOSMResponse","setName","setId","gridInstance","set","cachedResults","findBoundaryByName","inputName","results","then","extractBoundaries","areas","map","row","areaId","bbox","osm_type","osm_id","boundingbox","Number","parseFloat","osmId","osmType","display_name","Query","boundedQuery","queryBounds","queryString","promise","parts","collectAllNominatimQueries","runAllNominmantimQueries","resolvedQueryString","osmResponse","loadOptions","getQueryTemplate","run","lastProcessed","processNext","concat","part","geoType","join","pickFirstBoundary","first","assign","wait","boundaries","extendedQuery","match","geoTest","substr","ms","args","queryState","createQueryState","useSearch","isCacheEnabled","enableCache","unset","arguments","unsetPlace","areaServer","getDefaultLineColor","tinycolor","getLabelColor","getBackgroundColor","LoadOptions","overrides","wayFilter","timeout","maxHeapByteSize","outputMethod","raw","getBounds","serializeBBox","scene","rawOptions","protoLayer","getProtoLayer","getGridProjector","protoQueryBounds","getQueryBounds","layerDefinition","layers","queryLayerAll","queryLayer","components","LoadingIcon","lastCancel","noRoads","clicked","showWarning","hasValidArea","FIND_TEXT","watch","appState","mounted","$refs","input","focus","beforeDestroy","clearInterval","notifyStillLoading","methods","restoredState","restartLoadingMonitor","round","formatNumber","lastSuggestion","checkCache","useOSM","setInterval","config","generateNewProgressToken","byteArray","Uint8Array","arrayBuffer","Pbf","hasRoads","setIsArea","setBBox","console","progressToken","cancel","isFinite","toString","replace","restoreStateFromQueryString","nodeAndBox","getCurrentAreaId","parseInt","getCurrentNodeAndBox","parseBBox","bboxStr","startClick","printable","$emit","nodeList","ctx","seed","createDocumentHandler","el","binding","vnode","mouseup","mousedown","context","contains","popperElm","methodName","bindingFn","document","documentHandler","update","unbind","len","props","$el","receiveFocus","pointerEvents","looseFocus","blur","showPicker","panelLeft","panelTop","pickerType","colors","hex","a","colorValue","computed","isTransparent","btnStyle","background","backgroundImage","backgroundPosition","backgroundSize","val","oldVal","updateColorObject","newVal","triggerRect","PANEL_HEIGHT","innerHeight","desiredTop","max","desiredLeft","PICKER_WIDTH","innerWidth","hide","rgba","colorObj","toHexString","hsl","toHsl","hsv","toHsv","toRgb","getAlpha","wgl","require","counter","GridLayer","_color","lines","dx","dy","hidden","_lineWidth","unsafeColor","toRatioColor","renderFrame","newValue","setLineWidth","bindToScene","getProjectedRect","initialSceneSize","warn","_transferTransform","WireCollection","allowColors","is3D","forEachWay","from","to","add","removeChild","buildLinesCollection","appendChild","log","translate","updateWorldTransform","g","b","svgExport","renderer","getRenderer","svgExportSettings","close","getPrintableElements","minLength","beforeWrite","path","pathLength","hypot","svg","toSVG","dpr","getPixelRatio","SVGSVGElement","setAttribute","content","XMLSerializer","serializeToString","removeAttribute","label","text","insecurelyEscaped","leftOffset","paddingRight","bottomOffset","paddingBottom","fontSize","fontFamily","filter","collectPrintable","blob","Blob","URL","createObjectURL","fileName","getFileName","createElement","href","click","revokeLater","toPNG","getPrintableCanvas","printableCanvas","toBlob","cityCanvas","getCanvas","getContext","render","drawImage","all","drawTextLabel","querySelector","extension","escapeFileName","Date","toISOString","str","devicePixelRatio","image","Image","onload","src","btoa","save","font","fillStyle","textAlign","fillText","restore","Array","querySelectorAll","computedStyle","getComputedStyle","getBoundingClientRect","innerText","fill","revokeObjectURL","createScene","canvas","lastLineColor","triggerTransform","triggerAdd","triggerRemove","setClearColor","camera","getCamera","setMoveSpeed","setRotationSpeed","PI","gl","getGL","blendFuncSeparate","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ONE","slowDownZoom","backgroundColor","listenToEvents","sceneAPI","clear","destroy","getWGL","dispose","unsubscribeFromEvents","bus","firstLayer","rawColor","load","saveToPNG","saveToSVG","queryFilter","runFromOptions","setProjector","setGrid","gridLayer","indexOf","viewBox","getViewBox","setViewBox","onKeyDown","onKeyUp","removeEventListener","shiftKey","setSpeed","imageUrl","productKinds","mug","getZazzleLink","kind","productCode","imageEncoded","generateZazzleLink","imageContent","toDataURL","form","FormData","append","success","link","createOverlayManager","overlay","downEvent","clickedElement","time","now","handleMouseDown","handleMouseUp","handleTouchStart","passive","capture","handleTouchEnd","track","activeOverlays","deselect","onPointerDown","clientX","clientY","handleMouseMove","onPointerMove","onPointerUp","touches","touch","changedTouches","gotSomethingSelected","stopPropagation","handleTouchMove","foundElement","findTrackedElementUnderCursor","secondTimeClicking","shouldAddOverlay","classList","addDragOverlay","bBox","removeOverlay","isSingleClick","select","timeDiff","autoTrack","getRectangle","intersects","remove","domElement","FindPlace","EditableLabel","ColorPicker","showSettings","settingsOpen","labelColor","toRGBA","created","handleSceneTransform","syncBackground","syncLineColor","split","visibility","updateLayers","toRgbString","root","children","lastLayer","newLayers","newColor","newBackground","updateBackground","setBackgroundColor","recordOpenClick","ga","logError","exDescription","filename","lineno","exFatal","Vue","productionTip","requireModule","d3Require","isWebGLEnabled","h","App","$mount","NoWebGL","forEachElement","finish","CanvasPrototype","HTMLCanvasElement","hasBlobConstructor","Boolean","hasArrayBufferViewSupport","size","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","dataURIPattern","dataURLtoBlob","atob","ArrayBuffer","dataURI","matches","mediaType","isBase64","dataString","byteString","intArray","bb","decodeURIComponent","charCodeAt","getBlob","mozGetAsFile","quality","self","define"],"mappings":"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","file":"js/app.db404a92.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","'use strict'; // code generated by pbf v3.2.1\n\n// place ========================================\n\nvar place = exports.place = {};\n\nplace.read = function (pbf, end) {\n    return pbf.readFields(place._readField, {version: 0, name: \"\", date: \"\", id: \"\", nodes: [], ways: []}, end);\n};\nplace._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.version = pbf.readVarint();\n    else if (tag === 2) obj.name = pbf.readString();\n    else if (tag === 3) obj.date = pbf.readString();\n    else if (tag === 4) obj.id = pbf.readString();\n    else if (tag === 5) obj.nodes.push(place.node.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 6) obj.ways.push(place.way.read(pbf, pbf.readVarint() + pbf.pos));\n};\nplace.write = function (obj, pbf) {\n    if (obj.version) pbf.writeVarintField(1, obj.version);\n    if (obj.name) pbf.writeStringField(2, obj.name);\n    if (obj.date) pbf.writeStringField(3, obj.date);\n    if (obj.id) pbf.writeStringField(4, obj.id);\n    if (obj.nodes) for (var i = 0; i < obj.nodes.length; i++) pbf.writeMessage(5, place.node.write, obj.nodes[i]);\n    if (obj.ways) for (i = 0; i < obj.ways.length; i++) pbf.writeMessage(6, place.way.write, obj.ways[i]);\n};\n\n// place.node ========================================\n\nplace.node = {};\n\nplace.node.read = function (pbf, end) {\n    return pbf.readFields(place.node._readField, {id: 0, lat: 0, lon: 0}, end);\n};\nplace.node._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.id = pbf.readVarint();\n    else if (tag === 2) obj.lat = pbf.readFloat();\n    else if (tag === 3) obj.lon = pbf.readFloat();\n};\nplace.node.write = function (obj, pbf) {\n    if (obj.id) pbf.writeVarintField(1, obj.id);\n    if (obj.lat) pbf.writeFloatField(2, obj.lat);\n    if (obj.lon) pbf.writeFloatField(3, obj.lon);\n};\n\n// place.way ========================================\n\nplace.way = {};\n\nplace.way.read = function (pbf, end) {\n    return pbf.readFields(place.way._readField, {nodes: []}, end);\n};\nplace.way._readField = function (tag, obj, pbf) {\n    if (tag === 1) pbf.readPackedVarint(obj.nodes);\n};\nplace.way.write = function (obj, pbf) {\n    if (obj.nodes) pbf.writePackedVarint(1, obj.nodes);\n};\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FindPlace.vue?vue&type=style&index=0&lang=stylus&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(!_vm.placeFound)?_c('find-place',{on:{\"loaded\":_vm.onGridLoaded}}):_vm._e(),_c('div',{attrs:{\"id\":\"app\"}},[(_vm.placeFound)?_c('div',[_c('div',{staticClass:\"controls\"},[_c('a',{staticClass:\"print-button\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.toggleSettings($event)}}},[_vm._v(\"Customize...\")]),_c('a',{staticClass:\"try-another\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.startOver($event)}}},[_vm._v(\"Try another city\")])]),(_vm.showSettings)?_c('div',{staticClass:\"print-window\"},[_c('h3',[_vm._v(\"Display\")]),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col\"},[_vm._v(\"Colors\")]),_c('div',{staticClass:\"col colors c-2\"},_vm._l((_vm.layers),function(layer){return _c('div',{key:layer.name,staticClass:\"color-container\"},[_c('color-picker',{on:{\"change\":layer.changeColor},model:{value:(layer.color),callback:function ($$v) {_vm.$set(layer, \"color\", $$v)},expression:\"layer.color\"}}),_c('div',{staticClass:\"color-label\"},[_vm._v(_vm._s(layer.name))])],1)}),0)]),_c('h3',[_vm._v(\"Export\")]),_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.zazzleMugPrint()}}},[_vm._v(\"Onto a mug\")]),_vm._m(0)]),(_vm.zazzleLink || _vm.generatingPreview)?_c('div',{staticClass:\"preview-actions message\"},[(_vm.zazzleLink)?_c('div',{staticClass:\"padded popup-help\"},[_vm._v(\" If your browser has blocked the new window, \"),_c('br'),_vm._v(\"please \"),_c('a',{attrs:{\"href\":_vm.zazzleLink,\"target\":\"_blank\"}},[_vm._v(\"click here\")]),_vm._v(\" to open it. \")]):_vm._e(),(_vm.generatingPreview)?_c('div',{staticClass:\"loading-container\"},[_c('loading-icon'),_vm._v(\" Generating preview url... \")],1):_vm._e()]):_vm._e(),_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.toPNGFile($event)}}},[_vm._v(\"As an image (.png)\")]),_c('span',{staticClass:\"col c-2\"},[_vm._v(\" Save the current screen as a raster image. \")])]),_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.toSVGFile($event)}}},[_vm._v(\"As a vector (.svg)\")]),_c('span',{staticClass:\"col c-2\"},[_vm._v(\" Save the current screen as a vector image. \")])]),(false)?_c('div',{staticClass:\"row\"},[_c('a',{staticClass:\"col\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.toProtobuf($event)}}},[_vm._v(\"To a .PBF file\")]),_c('span',{staticClass:\"col c-2\"},[_vm._v(\" Save the current data as a protobuf message. For developer use only. \")])]):_vm._e(),_c('h3',[_vm._v(\"About\")]),_vm._m(1)]):_vm._e()]):_vm._e()]),(_vm.placeFound)?_c('editable-label',{staticClass:\"city-name\",style:({color: _vm.labelColorRGBA}),attrs:{\"printable\":true,\"overlay-manager\":_vm.overlayManager},model:{value:(_vm.name),callback:function ($$v) {_vm.name=$$v},expression:\"name\"}}):_vm._e(),(_vm.placeFound)?_c('div',{staticClass:\"license printable can-drag\",style:({color: _vm.labelColorRGBA})},[_vm._v(\"data \"),_c('a',{style:({color: _vm.labelColorRGBA}),attrs:{\"href\":\"https://www.openstreetmap.org/about/\",\"target\":\"_blank\"}},[_vm._v(\"© OpenStreetMap\")])]):_vm._e()],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"col c-2\"},[_vm._v(\" Print what you see onto a mug. \"),_c('br'),_vm._v(\"Get a unique gift of your favorite city. \")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',[_vm._v(\"This website was created by \"),_c('a',{attrs:{\"href\":\"https://twitter.com/anvaka\",\"target\":\"_blank\"}},[_vm._v(\"@anvaka\")]),_vm._v(\". It downloads roads from OpenStreetMap and renders them with WebGL. \")]),_c('p',[_vm._v(\" You can find the entire \"),_c('a',{attrs:{\"href\":\"https://github.com/anvaka/city-roads\"}},[_vm._v(\"source code here\")]),_vm._v(\". If you love this website you can also \"),_c('a',{attrs:{\"href\":\"https://www.paypal.com/paypalme2/anvakos/3\"}},[_vm._v(\"buy me a coffee\")]),_vm._v(\" or \"),_c('a',{attrs:{\"href\":\"https://www.patreon.com/anvaka\"}},[_vm._v(\"support me on Patreon\")]),_vm._v(\", but you don't have to. \")])])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"find-place\",class:{centered: _vm.boxInTheMiddle }},[(_vm.boxInTheMiddle)?_c('div',[_c('h3',{staticClass:\"site-header\"},[_vm._v(\"city roads\")]),_c('p',{staticClass:\"description\"},[_vm._v(\"This website renders every single road within a city\")])]):_vm._e(),_c('form',{staticClass:\"search-box\",on:{\"submit\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.enteredInput),expression:\"enteredInput\"}],ref:\"input\",staticClass:\"query-input\",attrs:{\"type\":\"text\",\"placeholder\":\"Enter a city name to start\"},domProps:{\"value\":(_vm.enteredInput)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.enteredInput=$event.target.value}}}),(_vm.enteredInput && !_vm.hideInput)?_c('a',{staticClass:\"search-submit\",attrs:{\"type\":\"submit\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_vm._v(_vm._s(_vm.mainActionText))]):_vm._e()]),(_vm.showWarning)?_c('div',{staticClass:\"prompt message note shadow\"},[_vm._v(\" Note: Large cities may require 200MB+ of data transfer and may need a powerful device to render. \")]):_vm._e(),(!_vm.loading)?_c('div',{staticClass:\"results\"},[(_vm.suggestionsLoaded && _vm.suggestions.length)?_c('div',{staticClass:\"suggestions shadow\"},[_vm._m(0),_c('ul',_vm._l((_vm.suggestions),function(suggestion,index){return _c('li',{key:index},[_c('a',{staticClass:\"suggestion\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.pickSuggestion(suggestion)}}},[_c('span',[_vm._v(\" \"+_vm._s(suggestion.name)+\" \"),_c('small',[_vm._v(\"(\"+_vm._s(suggestion.type)+\")\")])])])])}),0)]):_vm._e(),(_vm.suggestionsLoaded && !_vm.suggestions.length && !_vm.loading && !_vm.error)?_c('div',{staticClass:\"no-results message shadow\"},[_vm._v(\" Didn't find matching cities. Try a different query? \")]):_vm._e(),(_vm.noRoads)?_c('div',{staticClass:\"no-results message shadow\"},[_vm._v(\" Didn't find any roads. Try a different query? \")]):_vm._e()]):_vm._e(),(_vm.error)?_c('div',{staticClass:\"error message shadow\"},[_c('div',[_vm._v(\"Sorry, we were not able to download data from the OpenStreetMap. It could be very busy at the moment processing other requests. \"),_c('br'),_c('br'),_vm._v(\" Please bookmark this website and \"),_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.retry($event)}}},[_vm._v(\"try again\")]),_vm._v(\" later?\")]),_c('div',{staticClass:\"error-links\"},[_c('a',{attrs:{\"href\":\"https://twitter.com/anvaka/status/1218971717734789120\",\"title\":\"see what it supposed to do\",\"target\":\"_blank\"}},[_vm._v(\"see how it should have worked\")]),_c('a',{attrs:{\"href\":_vm.getBugReportURL(_vm.error),\"title\":\"report error: \" + _vm.error,\"target\":\"_blank\"}},[_vm._v(\"report this bug\")])])]):_vm._e(),(_vm.loading)?_c('div',{staticClass:\"loading message shadow\"},[_c('loading-icon'),_c('span',[_vm._v(_vm._s(_vm.loading))]),_c('a',{staticClass:\"cancel-request\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.cancelRequest($event)}}},[_vm._v(\"cancel\")]),(_vm.stillLoading > 0)?_c('div',{staticClass:\"load-padding\"},[_vm._v(\" Still loading... \")]):_vm._e(),(_vm.stillLoading > 1)?_c('div',{staticClass:\"load-padding\"},[_vm._v(\" Sorry it takes so long! \")]):_vm._e()],1):_vm._e()])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"prompt message\"},[_c('div',[_vm._v(\"Select boundaries below to download all roads within\")]),_c('div',{staticClass:\"note\"},[_vm._v(\"large cities may require 200MB+ of data transfer and a powerful device\")])])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{staticClass:\"loader\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 32 32\",\"width\":\"12\",\"height\":\"12\",\"fill\":\"black\"}},[_c('path',{attrs:{\"opacity\":\".25\",\"d\":\"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4\"}}),_c('path',{attrs:{\"d\":\"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z\"}},[_c('animateTransform',{attrs:{\"attributeName\":\"transform\",\"type\":\"rotate\",\"from\":\"0 16 16\",\"to\":\"360 16 16\",\"dur\":\"0.8s\",\"repeatCount\":\"indefinite\"}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./LoadingIcon.vue?vue&type=template&id=5e3ceff5&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import eventify from 'ngraph.events';\n\nexport default class Progress {\n  constructor(notify) {\n    eventify(this)\n    this.callback = notify || Function.prototype;\n  }\n\n  cancel() {\n    this.isCancelled = true;\n    this.fire('cancel');\n  }\n\n  notify(progress) {\n    if (!this.isCancelled) {\n      this.callback(progress);\n    }\n  }\n\n  onCancel(callback) {\n    this.on('cancel', callback, this);\n  }\n\n  offCancel(callback) {\n    this.off('cancel', callback);\n  }\n}","import Progress from './Progress';\n\nexport default function request(url, options) {\n  if (!options) options = {};\n  let req;\n  let progress = options.progress || new Progress();\n  let isCancelled = false;\n  if (progress.on) {\n    progress.onCancel(cancelDownload);\n  }\n\n  return new Promise(download);\n\n  function cancelDownload() {\n    isCancelled = true;\n    if (req) {\n      req.abort();\n    }\n  }\n\n  function download(resolve, reject) {\n    req = new XMLHttpRequest();\n\n    if (typeof progress.notify === 'function') {\n      req.addEventListener('progress', updateProgress, false);\n    }\n\n    req.addEventListener('load', transferComplete, false);\n    req.addEventListener('error', transferFailed, false);\n    req.addEventListener('abort', transferCanceled, false);\n\n    req.open(options.method || 'GET', url);\n    if (options.responseType) {\n      req.responseType = options.responseType;\n    }\n\n    if (options.headers) {\n      Object.keys(options.headers).forEach(key => {\n        req.setRequestHeader(key, options.headers[key]);\n      });\n    }\n\n    if (options.method === 'POST') {\n      req.send(options.body);\n    } else {\n      req.send(null);\n    }\n\n    function updateProgress(e) {\n      if (e.lengthComputable) {\n        progress.notify({\n          loaded: e.loaded,\n          total: e.total,\n          percent: e.loaded / e.total,\n          lengthComputable: true\n        });\n      } else {\n        progress.notify({\n          loaded: e.loaded,\n          lengthComputable: false\n        });\n      }\n    }\n\n    function transferComplete() {\n      progress.offCancel(cancelDownload);\n\n      if (progress.isCancelled) return;\n\n      if (req.status !== 200) {\n        reject({\n          statusError: req.status,\n          message: `Unexpected status code ${req.status} when calling ${url}`\n        });\n        return;\n      }\n      var response = req.response;\n\n      if (options.responseType === 'json' && typeof response === 'string') {\n        // IE\n        response = JSON.parse(response);\n      }\n\n      setTimeout(() => resolve(response), 0);\n    }\n\n    function transferFailed() {\n      reject(`Failed to download ${url}`);\n    }\n\n    function transferCanceled() {\n      reject({\n        cancelled: true,\n        message: `Cancelled download of ${url}`\n      });\n    }\n  }\n}","import request from './request';\nimport Progress from './Progress';\n\nlet backends = [\n  'https://overpass.kumi.systems/api/interpreter',\n  'https://overpass-api.de/api/interpreter',\n  'https://overpass.openstreetmap.ru/cgi/interpreter'\n]\n\nexport default function postData(data, progress) {\n  progress = progress || new Progress();\n  const postData = {\n    method: 'POST',\n    responseType: 'json',\n    progress,\n    headers: {\n      'Content-type': 'application/x-www-form-urlencoded; charset=UTF-8'\n    },\n    body: 'data=' + encodeURIComponent(data),\n  };\n\n  let serverIndex = 0;\n\n  return fetchFrom(backends[serverIndex]);\n\n  function fetchFrom(overpassUrl) {\n    return request(overpassUrl, postData, 'POST')\n      .catch(handleError);\n  }\n\n  function handleError(err) {\n    if (err.cancelled) throw err;\n\n    if (serverIndex >= backends.length - 1) {\n      // we can't do much anymore\n      throw err;\n    } \n\n    if (err.statusError) {\n      progress.notify({\n        loaded: -1\n      });\n    }\n\n    serverIndex += 1;\n    return fetchFrom(backends[serverIndex])\n  }\n}","export default class BBox {\n  constructor() {\n    this.minX = Infinity;\n    this.minY = Infinity;\n    this.maxX = -Infinity;\n    this.maxY = -Infinity;\n  }\n\n  growBy(offset) {\n    this.minX -= offset;\n    this.minY -= offset;\n    this.maxX += offset;\n    this.maxY += offset;\n  }\n\n  get left() {\n    return this.minX;\n  }\n\n  get top() {\n    return this.minY;\n  }\n\n  get right() {\n    return this.maxX;\n  }\n\n  get bottom() {\n    return this.maxY;\n  }\n\n  get width() {\n    return this.maxX - this.minX;\n  }\n\n  get height() {\n    return this.maxY - this.minY;\n  }\n\n  get cx() {\n    return (this.minX + this.maxX)/2;\n  }\n\n  get cy() {\n    return (this.minY + this.maxY)/2;\n  }\n\n  addPoint(xIn, yIn) {\n    if (xIn === undefined) throw new Error('Point is not defined');\n    let x = xIn;\n    let y = yIn;\n    if (y === undefined) {\n      // xIn is a point object\n      x = xIn.x;\n      y = xIn.y;\n    }\n\n    if (x < this.minX) this.minX = x;\n    if (x > this.maxX) this.maxX = x;\n    if (y < this.minY) this.minY = y;\n    if (y > this.maxY) this.maxY = y;\n  }\n\n  addRect(rect) {\n    if (!rect) throw new Error('rect is not defined');\n    this.addPoint(rect.left, rect.top);\n    this.addPoint(rect.right, rect.top);\n    this.addPoint(rect.left, rect.bottom);\n    this.addPoint(rect.right, rect.bottom);\n  }\n\n  merge(otherBBox) {\n    if (otherBBox.minX < this.minX) this.minX = otherBBox.minX;\n    if (otherBBox.minY < this.minY) this.minY = otherBBox.minY;\n    if (otherBBox.maxX > this.maxX) this.maxX = otherBBox.maxX;\n    if (otherBBox.maxY > this.maxY) this.maxY = otherBBox.maxY;\n  }\n}","import BoundingBox from './BoundingBox';\nimport {geoMercator} from 'd3-geo';\n\n/**\n * All roads in the area\n */\nexport default class Grid {\n  constructor() {\n    this.elements = [];\n    this.bounds = new BoundingBox();\n    this.nodes = new Map();\n    this.wayPointCount = 0;\n    this.id = 0;\n    this.name = '';\n    this.isArea = true;\n    this.projector = undefined; \n  }\n\n  setName(name) {\n    this.name = name;\n  }\n\n  setId(id) {\n    this.id = id;\n  }\n\n  setIsArea(isArea) {\n    this.isArea = isArea;\n  }\n\n  setBBox(bboxString) {\n    this.bboxString = bboxString;\n  }\n\n  hasRoads() {\n    return this.wayPointCount > 0;\n  }\n\n  setProjector(newProjector) {\n    this.projector = newProjector;\n  }\n\n  static fromPBF(pbf) {\n    if (pbf.version !== 1) throw new Error('Unknown version ' + pbf.version);\n    let elementsOfOSMResponse = [];\n    pbf.nodes.forEach(node => {\n      node.type = 'node';\n      elementsOfOSMResponse.push(node)\n    });\n    pbf.ways.forEach(way => {\n      way.type = 'way';\n      elementsOfOSMResponse.push(way);\n    });\n\n    const grid = Grid.fromOSMResponse(elementsOfOSMResponse);\n    grid.setName(pbf.name);\n    grid.setId(pbf.id);\n    return grid;\n  }\n\n  static fromOSMResponse(elementsOfOSMResponse) {\n    let gridInstance = new Grid();\n\n    let nodes = gridInstance.nodes;\n    let bounds = gridInstance.bounds;\n    let wayPointCount = 0;\n\n    // TODO: async?\n    elementsOfOSMResponse.forEach(element => {\n      if (element.type === 'node') {\n        nodes.set(element.id, element);\n        bounds.addPoint(element.lon, element.lat);\n      } else if (element.type === 'way') {\n        wayPointCount += element.nodes.length;\n      }\n    });\n\n    gridInstance.elements = elementsOfOSMResponse;\n    gridInstance.wayPointCount = wayPointCount;\n    return gridInstance;\n  }\n\n  getProjectedRect() {\n    let bounds = this.bounds;\n    let project = this.getProjector();\n    let leftTop = project({lon: bounds.left, lat: bounds.bottom});\n    let rightBottom = project({lon: bounds.right, lat: bounds.top});\n    let left = leftTop.x;\n    let top = leftTop.y;\n    let bottom = rightBottom.y\n    let right = rightBottom.x;\n    return {\n      left, top, right, bottom,\n      width: right - left, height: Math.abs(bottom - top)\n    }\n  }\n\n  forEachElement(callback) {\n    this.elements.forEach(callback);\n  }\n\n  forEachWay(callback, enter, exit) {\n    let positions = this.nodes;\n    let project = this.getProjector();\n    this.elements.forEach(element => {\n      if (element.type !== 'way') return;\n\n      let nodeIds = element.nodes;\n      let node = positions.get(nodeIds[0])\n      if (!node) return;\n\n      let last = project(node);\n      if (enter) enter(element);\n\n      for (let index = 1; index < nodeIds.length; ++index) {\n        node = positions.get(nodeIds[index])\n        if (!node) continue;\n        let next = project(node);\n\n        callback(last, next);\n\n        last = next;\n      }\n      if (exit) exit(element);\n    });\n  }\n\n  getProjector() {\n    let q = [0, 0]; // reuse to avoid GC.\n\n    if (!this.projector) {\n      this.projector = geoMercator();\n      this.projector\n        .center([this.bounds.cx, this.bounds.cy])\n        .scale(6371393); // Radius of Earth\n    }\n\n    let projector = this.projector;\n\n    return project;\n\n    function project({lon, lat}) {\n      q[0] = lon; q[1] = lat;\n\n      let xyPoint = projector(q);\n\n      return {\n        x: xyPoint[0],\n        y: -xyPoint[1]\n      };\n    }\n  }\n}","import request from './request';\n\nlet cachedResults = new Map();\n\nexport default function findBoundaryByName(inputName) {\n  let results = cachedResults.get(inputName);\n  if (results) return Promise.resolve(results);\n\n  let name = encodeURIComponent(inputName);\n  return request(`https://nominatim.openstreetmap.org/search?format=json&q=${name}`, {responseType: 'json'})\n      .then(extractBoundaries)\n      .then(x => {\n        cachedResults.set(inputName, x);\n        return x;\n      });\n}\n\nfunction extractBoundaries(x) {\n  let areas = x.map(row => {\n      let areaId, bbox;\n      if (row.osm_type === 'relation') {\n        // By convention the area id can be calculated from an existing \n        // OSM way by adding 2400000000 to its OSM id, or in case of a \n        // relation by adding 3600000000 respectively. So we are adding this\n        // https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL#By_area_.28area.29\n        // Note: we may want to do another case for osm_type = 'way'. Need to check\n        // if it returns correct values.\n        areaId = row.osm_id + 36e8;\n      } else if (row.osm_type === 'way') {\n        areaId = row.osm_id + 24e8;\n      }\n      if (row.boundingbox) {\n        bbox = [\n          Number.parseFloat(row.boundingbox[0]),\n          Number.parseFloat(row.boundingbox[2]),\n          Number.parseFloat(row.boundingbox[1]),\n          Number.parseFloat(row.boundingbox[3]),\n        ];\n      }\n\n      return {\n        areaId,\n        bbox,\n        lat: row.lat,\n        lon: row.lon,\n        osmId: row.osm_id,\n        osmType: row.osm_type,\n        name: row.display_name,\n        type: row.type,\n      };\n    });\n\n  return areas;\n}","import postData from './postData';\nimport Grid from './Grid';\nimport findBoundaryByName from './findBoundaryByName';\n\nexport default class Query {\n  /**\n   * Every possible way\n   */\n  static All = 'way';\n\n  /**\n   * Every single building\n   */\n  static Building = 'way[building]';\n  /**\n   * This gets anything marked as a highway, which has its own pros and cons.\n   * See https://github.com/anvaka/city-roads/issues/20\n   */\n  static Road = 'way[highway]';\n\n  /**\n   * Reduced set of roads\n   */\n  static RoadBasic = 'way[highway~\"^(motorway|primary|secondary|tertiary)|residential\"]';\n\n  /**\n   * More accurate representation of the roads by @RicoElectrico.\n   */\n  static RoadStrict = 'way[highway~\"^(((motorway|trunk|primary|secondary|tertiary)(_link)?)|unclassified|residential|living_street|pedestrian|service|track)$\"][area!=yes]';\n\n  static runFromOptions(loadOptions, progress) {\n    return loadOptions.getQueryTemplate().then(boundedQuery => {\n      let q = new Query(boundedQuery, progress);\n      return q.run();\n    });\n  }\n\n  constructor(boundedQuery, progress) {\n    this.queryBounds = boundedQuery.bounds;\n    this.queryString = boundedQuery.queryString;\n    this.progress = progress;\n    this.promise = null;\n  }\n\n  run() {\n    if (this.promise) {\n      return this.promise;\n    }\n    let parts = collectAllNominatimQueries(this.queryString);\n\n    this.promise = runAllNominmantimQueries(parts)\n      .then(resolvedQueryString => postData(resolvedQueryString, this.progress))\n      .then(osmResponse => {\n        let grid = Grid.fromOSMResponse(osmResponse.elements)\n        grid.queryBounds = this.queryBounds;\n        return grid;\n      });\n\n    return this.promise;\n  }\n}\n\nfunction runAllNominmantimQueries(parts) {\n  let lastProcessed = 0;\n\n  return processNext().then(concat);\n\n  function concat() {\n    return parts.map(part => {\n      if (typeof part === 'string') {\n        return part;\n      } \n      if (part.geoType === 'Area') return `area(${part.areaId})`;\n      if (part.geoType === 'Coords') return part.lat + ',' + part.lon;\n      if (part.geoType === 'Id') return `${part.osmType}(${part.osmId})`;\n      if (part.geoType === 'Bbox') return part.bbox.join(',');\n \n    }).join('');\n  }\n  \n  function processNext() {\n    if (lastProcessed >= parts.length) {\n      return Promise.resolve();\n    }\n    \n    let part = parts[lastProcessed];\n    lastProcessed += 1;\n    if (typeof part === 'string') return processNext();\n\n    return findBoundaryByName(part.name)\n      .then(pickFirstBoundary)\n      .then(first => {\n        if (!first) {\n          throw new Error('No areas found for request ' + part.name);\n        }\n        Object.assign(part, first);\n      })\n      .then(wait(1000)) // per nominatim agreement we are not allowed to issue more tan 1 request per second\n      .then(processNext);\n  }\n}\n\nfunction pickFirstBoundary(boundaries) {\n  if (boundaries.length > 0) {\n    return boundaries[0];\n  }\n}\n\nfunction collectAllNominatimQueries(extendedQuery) {\n  let geoTest = /{{geocode(.+?):(.+?)}}/;\n  let match;\n  let parts = [];\n  let lastIndex = 0;\n  while ((match = extendedQuery.match(geoTest))) {\n    parts.push(extendedQuery.substr(0, match.index));\n    parts.push({\n      geoType: match[1],\n      name: match[2]\n    });\n    extendedQuery = extendedQuery.substr(match.index + match[0].length)\n  }\n\n  parts.push(extendedQuery);\n\n  return parts;\n}\n\nfunction wait(ms) {\n  return function(args) {\n    return new Promise(resolve => {\n      setTimeout(() => resolve(args), ms);\n    });\n  }\n}\n\n","import createQueryState from 'query-state';\n\nconst queryState = createQueryState({}, {useSearch: true});\n\n/**\n * This is our base state. It just persists default information about\n * custom settings and integrates with query string.\n */\nexport default {\n  isCacheEnabled() {\n    return queryState.get('cache') != 0;\n  },\n  enableCache() {\n    return queryState.unset('cache');\n  },\n  get() {\n    return queryState.get.apply(queryState, arguments);\n  },\n  set() {\n    return queryState.set.apply(queryState, arguments);\n  },\n  unset() {\n    return queryState.unset.apply(queryState, arguments);\n  },\n\n  unsetPlace() {\n    queryState.unset('areaId');\n    queryState.unset('osm_id');\n    queryState.unset('bbox');\n  }\n}","import tinycolor from 'tinycolor2';\n\nexport default {\n  /**\n   * This is our caching backend\n   */\n  // This used to work, but seems like GitHub no longer allows large website hosting:\n  //areaServer: 'https://anvaka.github.io/index-large-cities/data',\n  //areaServer: 'http://localhost:8085', // This is un-commented when I develop cache locally\n  // So, using S3\n  areaServer: 'https://city-roads.s3-us-west-2.amazonaws.com/nov-02-2020',\n\n  getDefaultLineColor() {\n    return tinycolor('rgba(26, 26, 26, 0.8)');\n  },\n  getLabelColor() {\n    return tinycolor('#161616');\n  },\n\n  getBackgroundColor() {\n    return tinycolor('#F7F2E8');\n  }\n}","import findBoundaryByName from \"./findBoundaryByName\";\n\n/**\n * For console API we allow a lot of flexibility to fetch data\n * This component normalizes input arguments and turns them into unified\n * options object\n */\n\nexport default class LoadOptions {\n  static parse(scene, wayFilter, rawOptions) {\n    let result = new LoadOptions();\n    if (typeof rawOptions === 'string') {\n      result.place = rawOptions;\n    }\n\n    if (wayFilter) {\n      result.wayFilter = wayFilter;\n    }\n\n    if (!rawOptions) return result;\n\n    Object.assign(result, rawOptions);\n\n    let protoLayer = getProtoLayer(scene, rawOptions.layer);\n    if (protoLayer) {\n      result.projector = protoLayer.getGridProjector();\n      let protoQueryBounds = protoLayer.getQueryBounds();\n      if (protoQueryBounds && !result.place && !result.areaId && !result.bbox) {\n        // use bounds of the parent layer unless we have our own override.\n        result.place = protoQueryBounds.place;\n        result.areaId = protoQueryBounds.areaId;\n        result.bbox = protoQueryBounds.bbox;\n      }\n    }\n\n    if (rawOptions.projector) {\n      // user defined projection. See https://github.com/d3/d3-geo for the projector reference:\n      result.projector = projector;\n    }\n\n    return result;\n  }\n\n  constructor(overrides) {\n    /**\n    * Query that should be translated to area id by nominatim;\n    */\n    this.place = undefined;\n\n    /**\n    * Which projector should be used to map lon/lat to layer's x/y\n    */\n    this.projector = undefined;\n    this.wayFilter = undefined;\n    this.timeout = 900;\n    this.maxHeapByteSize = 1073741824;\n    this.outputMethod = 'skel'; // body\n    Object.assign(this, overrides);\n  }\n\n  getQueryTemplate() {\n    if (this.raw) {\n      // I assume you know what you are doing.\n      return Promise.resolve({\n        queryString: this.raw\n      });\n    }\n\n    if (!this.wayFilter) {\n      throw new Error('Way filter is required');\n    }\n\n    return this.getBounds()\n      .then(bounds => {\n        let queryString;\n        if (bounds.areaId) {\n          queryString = `[timeout:${this.timeout}][maxsize:${this.maxHeapByteSize}][out:json];\narea(${bounds.areaId});\n(._; )->.area;\n(${this.wayFilter}(area.area); node(w););\nout ${this.outputMethod};`;\n        } else if (bounds.bbox) {\n          let bbox = serializeBBox(bounds.bbox);\n          queryString = `[timeout:${this.timeout}][maxsize:${this.maxHeapByteSize}][bbox:${bbox}][out:json];\n(${this.wayFilter}; node(w););\nout ${this.outputMethod};`;\n        }\n\n        return {\n          bounds,\n          queryString\n        }\n      });\n  }\n\n  getBounds() {\n    if (this.place) {\n      return findBoundaryByName(this.place).then(x => x && x[0]);\n    }\n    if (this.areaId) {\n      return Promise.resolve({ areaId: this.areaId });\n    }\n    if (this.bbox) {\n      return Promise.resolve({ bbox: this.bbox });\n    }\n\n    throw new Error('Please specify bounding area for the query (place|areaId|bbox)');\n  }\n}\n\nfunction getProtoLayer(scene, layerDefinition) {\n  if (layerDefinition === undefined) return;\n\n  if (typeof layerDefinition === 'number') {\n    let layers = scene.queryLayerAll();\n    return layers[layerDefinition];\n  } else if (typeof layerDefinition === 'string') {\n    return scene.queryLayer(layerDefinition);\n  } else {\n    // We assume it is a layer instance:\n    return layerDefinition;\n  }\n}\n\nfunction serializeBBox(bbox) {\n  return bbox && bbox.join(',');\n}","<template>\n<div class='find-place' :class='{centered: boxInTheMiddle }'>\n  <div v-if='boxInTheMiddle'>\n    <h3 class='site-header'>city roads</h3>\n    <p class='description'>This website renders every single road within a city</p>\n  </div>\n  <form v-on:submit.prevent=\"onSubmit\" class='search-box'>\n      <input class='query-input' v-model='enteredInput' type='text' placeholder='Enter a city name to start' ref='input'>\n      <a type='submit' class='search-submit' href='#' @click.prevent='onSubmit' v-if='enteredInput && !hideInput'>{{mainActionText}}</a>\n  </form>\n  <div v-if='showWarning' class='prompt message note shadow'>\n    Note: Large cities may require 200MB+ of data transfer and may need a powerful device to render.\n  </div>\n  <div class='results' v-if='!loading'>\n    <div v-if='suggestionsLoaded && suggestions.length' class='suggestions shadow'>\n      <div class='prompt message'>\n        <div>Select boundaries below to download all roads within</div>\n        <div class='note'>large cities may require 200MB+ of data transfer and a powerful device</div>\n      </div>\n      <ul>\n        <li v-for='(suggestion, index) in suggestions' :key=\"index\">\n          <a @click.prevent='pickSuggestion(suggestion)' class='suggestion'\n          href='#'>\n          <span>\n          {{suggestion.name}} <small>({{suggestion.type}})</small>\n          </span>\n          </a>\n        </li>\n      </ul>\n    </div>\n    <div v-if='suggestionsLoaded && !suggestions.length && !loading && !error' class='no-results message shadow'>\n      Didn't find matching cities. Try a different query?\n    </div>\n    <div v-if='noRoads' class='no-results message shadow'>\n      Didn't find any roads. Try a different query?\n    </div>\n  </div>\n  <div v-if='error' class='error message shadow'>\n    <div>Sorry, we were not able to download data from the OpenStreetMap.\n    It could be very busy at the moment processing other requests. <br/><br/> Please bookmark this website and <a href='#' @click.prevent=\"retry\">try again</a> later?</div>\n    <div class='error-links'>\n      <a href='https://twitter.com/anvaka/status/1218971717734789120' title='see what it supposed to do' target=\"_blank\">see how it should have worked</a>\n      <a :href='getBugReportURL(error)' :title='\"report error: \" + error' target='_blank'>report this bug</a>\n    </div>\n  </div>\n  <div v-if='loading' class='loading message shadow'>\n    <loading-icon></loading-icon>\n    <span>{{loading}}</span>\n    <a href=\"#\" @click.prevent='cancelRequest' class='cancel-request'>cancel</a>\n    <div class='load-padding' v-if='stillLoading > 0'>\n      Still loading...\n    </div>\n    <div class='load-padding' v-if='stillLoading > 1'>\n      Sorry it takes so long!\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport LoadingIcon from './LoadingIcon';\nimport Query from '../lib/Query';\nimport request from '../lib/request';\nimport findBoundaryByName from '../lib/findBoundaryByName';\nimport appState from '../lib/appState';\nimport Grid from '../lib/Grid';\nimport queryState from '../lib/appState';\nimport config from '../config';\nimport Progress from '../lib/Progress'\nimport LoadOptions from '../lib/LoadOptions';\n\nconst FIND_TEXT = 'Find City Bounds';\n\nexport default {\n  name: 'FindPlace',\n  components: {\n    LoadingIcon\n  },\n  data () {\n    const enteredInput = appState.get('q') || '';\n    let hasValidArea = restoreStateFromQueryString();\n\n    return {\n      enteredInput,\n      loading: null,\n      lastCancel: null,\n      suggestionsLoaded: false,\n      boxInTheMiddle: true,\n      stillLoading: 0,\n      error: null,\n      hideInput: false,\n      noRoads: false,\n      clicked: false,\n      showWarning: hasValidArea, \n      mainActionText: hasValidArea ? 'Download Area' : FIND_TEXT,\n      suggestions: []\n    }\n  },\n  watch: {\n    enteredInput() {\n      // As soon as they change it, we need not to download:\n      this.mainActionText = FIND_TEXT;\n      this.showWarning = false;\n      this.hideInput = false;\n      appState.unsetPlace();\n    }\n  },\n  mounted() {\n    this.$refs.input.focus();\n  },\n  beforeDestroy() {\n    if (this.lastCancel) this.lastCancel();\n    clearInterval(this.notifyStillLoading);\n  },\n  methods: {\n    onSubmit() {\n      queryState.set('q', this.enteredInput);\n      this.cancelRequest()\n      this.suggestions = [];\n      this.noRoads = false;\n      this.error = false;\n      this.showWarning = false;\n\n      const restoredState = restoreStateFromQueryString(this.enteredInput);\n      if (restoredState) {\n        this.pickSuggestion(restoredState);\n        return;\n      }\n\n      const query = encodeURIComponent(this.enteredInput);\n      this.loading = 'Searching cities that match your query...'\n      findBoundaryByName(this.enteredInput)\n        .then(suggestions => {\n          this.loading = null;\n          this.hideInput = suggestions && suggestions.length;\n          if (this.boxInTheMiddle) {\n            // let animation that moves input box proceed a bit\n            this.boxInTheMiddle = false; // This triggers transition\n            // wait for it and then set the suggestions:\n            setTimeout(() => {\n              this.suggestionsLoaded = true;\n              this.suggestions = suggestions;\n            }, 50)\n          } else {\n              this.suggestionsLoaded = true;\n              this.suggestions = suggestions; \n          }\n        });\n    },\n\n    getBugReportURL(error) {\n      let title = encodeURIComponent('OSM Error');\n      let body = '';\n      if (error) {\n        body = 'Hello, an error occurred on the website:\\n\\n```\\n' +\n          error.toString() + '\\n```\\n\\n Can you please help?';\n      }\n\n      return `https://github.com/anvaka/city-roads/issues/new?title=${title}&body=${encodeURIComponent(body)}`\n    },\n\n    updateProgress(status) {\n      this.stillLoading = 0;\n      clearInterval(this.notifyStillLoading);\n      if (status.loaded < 0) {\n        this.loading = 'Trying a different server'\n        this.restartLoadingMonitor();\n        return;\n      }\n      if (status.percent !== undefined) {\n        this.loading = 'Loaded ' + Math.round(100 * status.percent) + '% (' + formatNumber(status.loaded) + ' bytes)...';\n      } else {\n        this.loading = 'Loaded ' + formatNumber(status.loaded) + ' bytes...';\n      }\n    },\n\n    retry() {\n      if (this.lastSuggestion) {\n        this.pickSuggestion(this.lastSuggestion);\n      }\n    },\n\n    pickSuggestion(suggestion) {\n      this.lastSuggestion = suggestion;\n      this.error = false;\n      if (appState.isCacheEnabled() && suggestion.areaId) {\n        this.checkCache(suggestion)\n          .catch(error => {\n            if (error.cancelled) return; // no need to do anything. They've cancelled\n\n            // No Cache - fallback\n            return this.useOSM(suggestion);\n          });\n      } else {\n        // we don't have cache for nodes yet.\n        this.useOSM(suggestion);\n      }\n    },\n\n    restartLoadingMonitor() {\n      clearInterval(this.notifyStillLoading);\n      this.stillLoading = 0;\n      this.notifyStillLoading = setInterval(() => {\n        this.stillLoading++;\n      }, 10000);\n    },\n\n    checkCache(suggestion) {\n      this.loading = 'Checking cache...'\n      let areaId = suggestion.areaId;\n\n      return request(config.areaServer + '/' + areaId + '.pbf', {\n        progress: this.generateNewProgressToken(),\n        responseType: 'arraybuffer'\n      }).then(arrayBuffer => {\n        var byteArray = new Uint8Array(arrayBuffer);\n        return byteArray;\n      }).then(byteArray => {\n        var Pbf = require('pbf');\n        var place = require('../proto/place.js').place;\n        var pbf = new Pbf(byteArray);\n        var obj = place.read(pbf);\n        let grid = Grid.fromPBF(obj)\n        this.$emit('loaded', grid);\n      });\n    },\n\n    useOSM(suggestion) {\n      this.loading = 'Connecting to OpenStreetMap...'\n      \n      // it may take a while to load data. \n      this.restartLoadingMonitor();\n      Query.runFromOptions(new LoadOptions({\n        wayFilter: Query.Road,\n        areaId: suggestion.areaId,\n        bbox: suggestion.bbox\n      }), this.generateNewProgressToken())\n      .then(grid => {\n        this.loading = null;\n        if (!grid.hasRoads()) {\n          this.noRoads = true;\n        } else {\n          grid.setName(suggestion.name);\n          grid.setId(suggestion.areaId || suggestion.osm_id);\n          grid.setIsArea(suggestion.areaId); // osm nodes don't have area.\n          grid.setBBox(serializeBBox(suggestion.bbox));\n          this.$emit('loaded', grid);\n        }\n      }).catch(err => {\n        if (err.cancelled) {\n          this.loading = null;\n          return;\n        }\n        console.error(err);\n        this.error = err;\n        this.loading = null;\n        this.suggestions = [];\n      })\n      .finally(() => {\n        clearInterval(this.notifyStillLoading);\n        this.stillLoading = 0;\n      });\n    },\n\n    cancelRequest() {\n      if (this.progressToken) {\n        this.progressToken.cancel();\n        this.progressToken = null;\n        this.loading = false;\n      }\n    },\n\n    generateNewProgressToken() {\n      if (this.progressToken) {\n        this.progressToken.cancel();\n        this.progressToken = null;\n      }\n\n      this.progressToken = new Progress(this.updateProgress);\n      return this.progressToken;\n    }\n  }\n}\n\nfunction serializeBBox(bbox) {\n  return bbox && bbox.join(',');\n}\n\nfunction formatNumber(x) {\n  if (!Number.isFinite(x)) return 'N/A';\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\nfunction restoreStateFromQueryString(name) {\n  let areaId = getCurrentAreaId();\n  if (areaId) {\n    return {name, areaId};\n  }\n\n  let nodeAndBox = getCurrentNodeAndBox();\n  if (nodeAndBox) {\n    return {\n      name,\n      osm_id: nodeAndBox.osm_id,\n      bbox: nodeAndBox.bbox\n    };\n  }\n}\n\nfunction getCurrentAreaId() {\n  let areaId = appState.get('areaId');\n  if (!Number.isFinite(Number.parseInt(areaId, 10))) {\n    areaId = null;\n  }\n  return areaId;\n}\n\nfunction getCurrentNodeAndBox() {\n  let osm_id = appState.get('osm_id');\n  if (!Number.isFinite(Number.parseInt(osm_id, 10))) return;\n\n  let bbox = parseBBox(appState.get('bbox'));\n  if (!bbox) return;\n\n  return { osm_id, bbox };\n}\n\nfunction parseBBox(bboxStr) {\n  if (!bboxStr) return null;\n\n  let bbox = bboxStr.split(',').map(x => Number.parseFloat(x)).filter(x => Number.isFinite(x));\n  return bbox.length === 4 ? bbox : null;\n}\n\n</script>\n\n<style lang=\"stylus\">\n@import('../vars.styl');\n.find-place  {\n  width: desktop-controls-width;\n}\n\nh3.site-header {\n  margin: 0;\n  font-weight: normal;\n  font-size: 32px;\n  text-align: center;\n}\n\ninput {\n  border: none;\n  flex: 1;\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  padding: 0;\n  color: #434343;\n  height: 100%;\n  font-size: 16px;\n  &:focus {\n    outline: none;\n  }\n}\n\n.search-box {\n  position: relative;\n  background-color: emphasis-background;\n  padding: 0 8px;\n  padding: 0 0 0 8px;\n\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n  height: 48px;\n  display: flex;\n  font-size: 16px;\n  cursor: text;\n  a {\n    cursor: pointer;\n  }\n  span {\n    display: flex;\n    align-items: center;\n    flex-shrink: 0;\n  }\n}\n\n.prompt {\n  padding: 4px;\n  text-align: center;\n  font-size: 12px;\n}\n\n.search-submit {\n  padding: 0 8px;\n  align-items: center;\n  text-decoration: none;\n  display: flex;\n  flex-shrink: 0;\n  justify-content: center;\n  outline: none;\n  z-index: 1;\n  color: highlight-color\n  &:hover {\n    color: emphasis-background;\n    background: highlight-color;\n  }\n}\n\n.suggestion {\n  display: block\n  min-height: 64px\n  align-items: center;\n  border-bottom: 1px solid border-color\n  display: flex\n  padding: 0 10px;\n  text-decoration: none\n  color: highlight-color\n}\n\n.suggestions {\n  position: relative;\n  background: white\n  .note {\n    font-size: 10px;\n    font-style: italic;\n  }\n\n  ul {\n    list-style-type: none;\n    margin: 0;\n    padding: 0;\n    max-height: calc(100vh - 128px);\n    overflow-y: auto;\n    overflow-x: hidden;\n  }\n}\n\n.message,\n.loading {\n  padding: 4px 8px;\n  position: relative;\n}\n.loading svg {\n  margin-right: 8px;\n}\n\n.shadow {\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2)\n}\n\n.error {\n  overflow-x: auto;\n}\n\n.find-place {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  top: 8px;\n  left: 50%;\n\n  transform: translateX(-50%) translateY(0);\n  transition-timing-function: ease-out;\n  transition-property: top left transform;\n  transition-duration: 0.2s;\n}\n\n.find-place.centered {\n  top: 50%;\n  left: 50%;\n  transform: translateX(-50%) translateY(-143px);\n}\n.load-padding {\n  padding-left: 16px;\n}\n.description {\n  padding: 8px;\n  margin: 0;\n  text-align: center;\n}\n\n.cancel-request {\n  position: absolute;\n  right: 4px;\n  top: 4px;\n  font-size: 12px;\n}\n.error-links {\n  display: flex;\n  justify-content: space-between;\n  font-size: 12px;\n}\n\n@media (max-width: small-screen) {\n  .find-place {\n    width: 100%;\n  }\n  .find-place.centered {\n    top: 8px;\n    left: 0;\n    transform: none;\n  }\n  .message {\n    font-size: 12px;\n  }\n  .prompt {\n    font-size: 12px;\n    .note {\n      font-size: 9px;\n    }\n  }\n}\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FindPlace.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FindPlace.vue?vue&type=script&lang=js&\"","// Based on https://github.com/ElemeFE/element/blob/dev/src/utils/clickoutside.js\n// The MIT License (MIT), Copyright (c) 2016 ElemeFE\nconst nodeList = [];\nconst ctx = '@@clickoutsideContext';\n\nlet startClick;\nlet seed = 0;\n\ndocument.addEventListener('mousedown', e => (startClick = e), true);\ndocument.addEventListener('mouseup', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n}, true);\n\n// Also hide when tapped outside.\ndocument.addEventListener('touchstart', e => {\n  startClick = e;\n}, true);\ndocument.addEventListener('touchend', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n}, true);\n\nfunction createDocumentHandler(el, binding, vnode) {\n  return function(mouseup = {}, mousedown = {}) {\n    if (!vnode || !vnode.context ||\n      !mouseup.target || !mousedown.target ||\n      el.contains(mouseup.target) ||\n      el.contains(mousedown.target) ||\n      el === mouseup.target ||\n      (vnode.context.popperElm &&\n      (vnode.context.popperElm.contains(mouseup.target) ||\n      vnode.context.popperElm.contains(mousedown.target)))) return;\n\n    const methodName = el[ctx].methodName;\n    if (binding.expression && methodName && vnode.context[methodName]) {\n      vnode.context[methodName]();\n    } else {\n      el[ctx].bindingFn && el[ctx].bindingFn();\n    }\n  };\n}\n\nexport default {\n  bind(el, binding, vnode) {\n    nodeList.push(el);\n    const id = seed++;\n    el[ctx] = {\n      id,\n      documentHandler: createDocumentHandler(el, binding, vnode),\n      methodName: binding.expression,\n      bindingFn: binding.value\n    };\n  },\n\n  update(el, binding, vnode) {\n    el[ctx].documentHandler = createDocumentHandler(el, binding, vnode);\n    el[ctx].methodName = binding.expression;\n    el[ctx].bindingFn = binding.value;\n  },\n\n  unbind(el) {\n    let len = nodeList.length;\n\n    for (let i = 0; i < len; i++) {\n      if (nodeList[i][ctx].id === el[ctx].id) {\n        nodeList.splice(i, 1);\n        break;\n      }\n    }\n    delete el[ctx];\n  }\n};","import { render, staticRenderFns } from \"./FindPlace.vue?vue&type=template&id=751d06f2&\"\nimport script from \"./FindPlace.vue?vue&type=script&lang=js&\"\nexport * from \"./FindPlace.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FindPlace.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.looseFocus),expression:\"looseFocus\"}],staticClass:\"can-drag\"},[_c('div',{staticClass:\"editable-label\"},[_c('span',{class:{printable: _vm.printable}},[_vm._v(_vm._s(_vm.value))]),_c('input',{ref:\"input\",domProps:{\"value\":_vm.value},on:{\"input\":function($event){return _vm.$emit('input', $event.target.value)}}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div v-click-outside='looseFocus' class='can-drag'>\n    <div class='editable-label'>\n      <span :class='{printable}'>{{value}}</span>\n      <input\n        v-bind:value=\"value\"\n        v-on:input=\"$emit('input', $event.target.value)\"\n        ref='input'\n      >\n    </div>\n  </div>\n</template>\n<script>\nimport ClickOutside from './clickOutside.js'\n\nexport default {\n  name: 'EditableLabel',\n  props: ['value', 'printable', 'overlayManager'],\n  directives: { ClickOutside },\n  mounted() {\n    this.$el.receiveFocus = this.focus;\n    this.$el.style.pointerEvents = 'none';\n  },\n  methods: {\n    looseFocus() {\n      this.$refs.input.blur();\n    },\n    focus() {\n      this.$refs.input.focus();\n    }\n  }\n}\n</script>\n<style lang=\"stylus\">\n@import('../vars.styl');\n\n.editable-label {\n  position: relative;\n\n  span {\n    position: relative;\n    top: 0;\n    left: 0;\n    display: flex;\n    align-items : center;\n    font-family: labels-font;\n    white-space: pre;\n    padding: 8px;\n    border: 1px solid transparent;\n  }\n\n  input {\n    caret-color: primary-text;\n    color: transparent;\n    font-family: labels-font;\n    background: transparent;\n    display: flex;\n    align-items: center;\n    position: absolute;\n    overflow: hidden;\n    top: 0;\n    left: 0;\n    width: 100%;\n    padding: 8px;\n  }\n}\n  \n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditableLabel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditableLabel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./EditableLabel.vue?vue&type=template&id=8f936aaa&\"\nimport script from \"./EditableLabel.vue?vue&type=script&lang=js&\"\nexport * from \"./EditableLabel.vue?vue&type=script&lang=js&\"\nimport style0 from \"./EditableLabel.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.hide),expression:\"hide\"}],staticClass:\"vue-colorpicker\",on:{\"click\":function($event){_vm.showPicker = true}}},[_c('span',{ref:\"triggerButton\",staticClass:\"vue-colorpicker-btn\",style:(_vm.btnStyle)}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showPicker),expression:\"showPicker\"}],staticClass:\"vue-colorpicker-panel\",style:({left: _vm.panelLeft, top: _vm.panelTop})},[_c(_vm.pickerType,{tag:\"component\",on:{\"input\":_vm.changeColor},model:{value:(_vm.colors),callback:function ($$v) {_vm.colors=$$v},expression:\"colors\"}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n<template>\n<div class='vue-colorpicker' @click='showPicker = true' v-click-outside='hide' >\n  <span class='vue-colorpicker-btn' :style='btnStyle' ref='triggerButton'></span>\n  <div class='vue-colorpicker-panel' v-show='showPicker' :style=\"{left: panelLeft, top: panelTop}\">\n    <component :is='pickerType' v-model='colors' @input='changeColor'></component>\n  </div>\n</div>\n</template>\n\n<script>\nimport tinycolor from 'tinycolor2'\nimport { Sketch } from 'vue-color'\nimport ClickOutside from './clickOutside.js'\n\nexport default {\n  name: 'vue-colorpicker',\n  components: {\n    'sketch-picker': Sketch,\n  },\n  directives: { ClickOutside },\n  props: {\n    value: {\n      type: Object,\n    },\n  },\n  data () {\n    return {\n      showPicker: false,\n      colors: {\n        hex: '#FFFFFF',\n        a: 1\n      },\n      colorValue: '#FFFFFF',\n      panelLeft: '0px',\n      panelTop: '0px'\n    }\n  },\n  computed: {\n    pickerType () {\n      return 'sketch-picker';\n    },\n    isTransparent () {\n      return this.colors.a === 0;\n    },\n    btnStyle () {\n      if (this.isTransparent) {\n        return {\n          background: '#eee',\n          backgroundImage: 'linear-gradient(45deg, rgba(0,0,0,.25) 25%, transparent 0, transparent 75%,rgba(0,0,0,.25)0), linear-gradient(45deg, rgba(0,0,0,.25)25%,transparent 0, transparent 75%,rgba(0,0,0,.25)0)',\n          backgroundPosition: '0 0, 11px 11px',\n          backgroundSize: '22px 22px'\n        }\n      }\n      let {r, g, b, a} = this.colorValue;\n      return {\n        background: `rgba(${r}, ${g}, ${b}, ${a})`\n      }\n    },\n  },\n  watch: {\n    value (val, oldVal) {\n      if (val !== oldVal) {\n        this.updateColorObject(val);\n      }\n    },\n    showPicker(newVal) {\n      if (!newVal) return;\n\n      const PICKER_WIDTH = 220;\n      const PANEL_HEIGHT = 320;\n      let triggerRect = this.$refs.triggerButton.getBoundingClientRect();\n      let desiredLeft = triggerRect.x;\n      let desiredTop = triggerRect.bottom;\n      if (triggerRect.y + PANEL_HEIGHT > window.innerHeight) {\n        desiredTop = Math.max(0, window.innerHeight - PANEL_HEIGHT);\n        desiredLeft += 36; // so that the selector button is still visible;\n      }\n      if (desiredLeft + PICKER_WIDTH > window.innerWidth) {\n        desiredLeft = Math.max(0, window.innerWidth - PICKER_WIDTH);\n      } \n      this.panelLeft = desiredLeft + 'px';\n      this.panelTop = desiredTop + 'px';\n    }\n  },\n\n  methods: {\n    hide () {\n      this.showPicker = false;\n    },\n    changeColor (data) {\n      this.colorValue = data.rgba;\n      this.$emit('input', this.colorValue)\n      this.$emit('change', this.colorValue)\n    },\n    updateColorObject (color) {\n      if (!color) return\n      const colorObj = tinycolor(color);\n      if (!color || color === 'transparent') {\n        this.colors = {\n          hex: '#FFFFFF',\n          hsl: { h: 0, s: 0, l: 1, a: 0 },\n          hsv: { h: 0, s: 0, v: 1, a: 0 },\n          rgba: { r: 255, g: 255, b: 255, a: 0 },\n          a: 0\n        };\n      } else {\n        this.colors = {\n          hex: colorObj.toHexString(),\n          hsl: colorObj.toHsl(),\n          hsv: colorObj.toHsv(),\n          rgba: colorObj.toRgb(),\n          a: colorObj.getAlpha()\n        };\n      }\n      this.colorValue = this.colors.rgba;\n    }\n  },\n  mounted () {\n    this.updateColorObject(this.value)\n  }\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n.vue-colorpicker {\n  display: inline-block;\n  box-sizing: border-box;\n  font-size: 0;\n  cursor: pointer;\n  &-btn {\n    display: inline-block;\n    width: 30px;\n    height: 22px;\n    border: 1px solid #666;\n    background: #FFFFFF;\n  }\n\n  .vue-colorpicker-panel {\n    position: absolute;\n    z-index: 1;\n  }\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ColorPicker.vue?vue&type=template&id=a5fc1b7c&scoped=true&\"\nimport script from \"./ColorPicker.vue?vue&type=script&lang=js&\"\nexport * from \"./ColorPicker.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ColorPicker.vue?vue&type=style&index=0&id=a5fc1b7c&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a5fc1b7c\",\n  null\n  \n)\n\nexport default component.exports","import eventify from 'ngraph.events';\n\n// we are going to use this as a global message bus inside the app.\nexport default eventify({});","import config from '../config';\nimport tinycolor from 'tinycolor2';\n\nconst wgl = require('w-gl');\nlet counter = 0;\n\nexport default class GridLayer {\n  get color() {\n    return this._color;\n  }\n\n  set color(unsafeColor) {\n    let color = tinycolor(unsafeColor);\n    this._color = color;\n    if (this.lines) {\n      this.lines.color = toRatioColor(color.toRgb());\n    }\n    if (this.scene) {\n      this.scene.renderFrame();\n    }\n  }\n\n  get lineWidth() {\n    return this._lineWidth;\n  }\n\n  set lineWidth(newValue) {\n    this._lineWidth = newValue;\n    if (!this.lines || !this.scene) return;\n\n    this.lines.setLineWidth(newValue);\n  }\n\n  constructor() {\n    this._color = config.getDefaultLineColor();\n    this.grid = null;\n    this.lines = null;\n    this.scene = null;\n    this.dx = 0;\n    this.dy = 0;\n    this.scale = 1;\n    this.hidden = false;\n    this.id = 'paths_' + counter;\n    this._lineWidth = 1;\n    counter += 1;\n  }\n\n  getGridProjector() {\n    if (this.grid) return this.grid.projector;\n  }\n\n  getQueryBounds() {\n    const {grid} = this;\n    if (grid) {\n      if (grid.queryBounds) return grid.queryBounds;\n      if (grid.isArea) return {\n        areaId: grid.id\n      };\n    }\n  }\n\n  setGrid(grid) {\n    this.grid = grid;\n    if (this.scene) {\n      this.bindToScene(this.scene);\n    }\n  }\n\n  getViewBox() {\n    if (!this.grid) return null;\n\n    let {width, height} = this.grid.getProjectedRect();\n    let initialSceneSize = Math.max(width, height) / 4;\n    return {\n      left:  -initialSceneSize,\n      top:    initialSceneSize,\n      right:  initialSceneSize,\n      bottom: -initialSceneSize,\n    };\n  }\n\n  moveTo(x, y = 0) {\n    console.warn('Please use moveBy() instead. The moveTo() is under construction');\n    // this.dx = x;\n    // this.dy = y;\n\n    // this._transferTransform();\n  }\n\n  moveBy(dx, dy = 0) {\n    this.dx = dx;\n    this.dy = dy;\n\n    this._transferTransform();\n  }\n\n  buildLinesCollection() {\n    if (this.lines) return this.lines;\n\n    let grid = this.grid;\n    let lines = new wgl.WireCollection(grid.wayPointCount, {\n      width: this._lineWidth,\n      allowColors: false,\n      is3D: false\n    });\n    grid.forEachWay(function(from, to) {\n      lines.add({from, to});\n    });\n    let color = tinycolor(this._color).toRgb();\n    lines.color = toRatioColor(color);\n    lines.id = this.id;\n\n    this.lines = lines;\n  }\n\n  destroy() {\n    if (!this.scene || !this.lines) return;\n\n    // TODO: This should remove the grid layer too. Need to clean up how\n    // scene interacts with grid layers.\n    this.scene.removeChild(this.lines);\n  }\n\n  bindToScene(scene) {\n    if (this.scene && this.lines) {\n      console.error('You seem to be adding this layer twice...')\n    }\n\n    this.scene = scene;\n    if (!this.grid) return;\n\n    this.buildLinesCollection();\n\n    if (this.hidden) return;\n    this.scene.appendChild(this.lines);\n  }\n\n  hide() {\n    if (this.hidden) return;\n    this.hidden = true;\n    if (!this.scene || !this.grid) return;\n\n    this.scene.removeChild(this.lines);\n  }\n\n  show() {\n    if (!this.hidden) return;\n    this.hidden = false;\n    if (!this.scene || !this.grid) {\n      console.log('Layer will be shown when grid is available');\n      return;\n    }\n\n    this.scene.appendChild(this.lines);\n  }\n\n  _transferTransform() {\n    if (!this.lines) return;\n\n    this.lines.translate([this.dx, this.dy, 0]);\n    this.lines.updateWorldTransform(true);\n    if (this.scene) {\n      this.scene.renderFrame(true);\n    }\n  }\n}\n\nfunction toRatioColor(c) {\n  return {r: c.r/0xff, g: c.g/0xff, b: c.b/0xff, a: c.a}\n}","let place = require('../proto/place.js').place;\nconst wgl = require('w-gl');\n\nexport default function svgExport(scene, options) {\n  const renderer = scene.getRenderer();\n  const svgExportSettings = {\n    open() {\n      return `<!-- Generator: https://github.com/anvaka/city-roads\nData © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright\n-->`;\n    },\n    close() {\n      return getPrintableElements();\n    }\n  };\n\n  if (options.minLength) {\n    svgExportSettings.beforeWrite = path => {\n      let pathLength = 0;\n      for (let i = 1; i < path.length; ++i) {\n        pathLength += Math.hypot(path[i].x - path[i - 1].x, path[i].y - path[i - 1].y);\n        if (pathLength > options.minLength) return true;\n      }\n      return pathLength > options.minLength;\n    }\n  }\n  svgExportSettings.round = options.round;\n\n  const svg = wgl.toSVG(renderer, svgExportSettings);\n\n  return svg;\n\n  function getPrintableElements() {\n    let dpr = renderer.getPixelRatio();\n\n    return options.printable.map(el => {\n      if (el.element instanceof SVGSVGElement) {\n        let bounds = el.bounds;\n        let x = bounds.left * dpr;\n        let y = bounds.top * dpr;\n        let svg = el.element;\n        svg.setAttribute('x', bounds.left * dpr);\n        svg.setAttribute('y', bounds.top * dpr);\n        svg.setAttribute('width', bounds.width * dpr);\n        svg.setAttribute('height', bounds.height * dpr);\n        let content = new XMLSerializer().serializeToString(el.element);\n        svg.removeAttribute('x');\n        svg.removeAttribute('y');\n        svg.removeAttribute('width');\n        svg.removeAttribute('height');\n        return content;\n      } else {\n        let label = el;\n        if (!label.text) return;\n        let insecurelyEscaped = label.text\n          .replace(/&/g, '&amp;')\n          .replace(/</g, '&lt;')\n          .replace(/>/g, '&gt;')\n        \n        // Note: this is not 100% accurate, might need to be fixed eventually\n        let bounds = label.bounds;\n        let leftOffset = (bounds.right - label.paddingRight) * dpr;\n        let bottomOffset = (bounds.bottom - label.paddingBottom) * dpr;\n        let fontSize = label.fontSize * dpr;\n\n        let fontFamily = label.fontFamily.replace(/\"/g, '\\'');\n        return `<text text-anchor=\"end\" x=\"${leftOffset}\" y=\"${bottomOffset}\" fill=\"${label.color}\" font-family=\"${fontFamily}\" font-size=\"${fontSize}\">${insecurelyEscaped}</text>`\n      }\n    }).filter(x => x).join('\\n')\n  }\n}","import protobufExport from './protobufExport';\nimport svgExport from './svgExport';\n\nexport function toSVG(scene, options) {\n  options = options || {};\n  let svg = svgExport(scene, { \n    printable: collectPrintable(),\n    ...options\n  });\n  let blob = new Blob([svg], {type: \"image/svg+xml\"});\n  let url = window.URL.createObjectURL(blob);\n  let fileName = getFileName(options.name, '.svg');\n  // For some reason, safari doesn't like when download happens on the same\n  // event loop cycle. Pushing it to the next one.\n  setTimeout(() => {\n    let a = document.createElement(\"a\");\n    a.href = url;\n    a.download = fileName;\n    a.click();\n    revokeLater(url);\n  }, 30)\n}\n\nexport function toPNG(scene, options) {\n  options = options || {};\n\n  getPrintableCanvas(scene).then((printableCanvas) => {\n    let fileName = getFileName(options.name, '.png');\n\n    printableCanvas.toBlob(function(blob) {\n      let url = window.URL.createObjectURL(blob);\n      let a = document.createElement(\"a\");\n      a.href = url;\n      a.download = fileName;\n      a.click();\n      revokeLater(url);\n    }, 'image/png')\n  })\n}\n\nexport function getPrintableCanvas(scene) {\n  let cityCanvas = getCanvas();\n  let width = cityCanvas.width;\n  let height = cityCanvas.height;\n\n  let printable = document.createElement('canvas');\n  let ctx = printable.getContext('2d');\n  printable.width = width;\n  printable.height = height;\n  scene.render();\n  ctx.drawImage(cityCanvas, 0, 0, cityCanvas.width, cityCanvas.height, 0, 0, width, height);\n\n  return Promise.all(collectPrintable().map(label => drawTextLabel(label, ctx))).then(() => {\n    return printable;\n  });\n}\n\nexport function getCanvas() {\n  return document.querySelector('#canvas')\n}\n\nfunction getFileName(name, extension) {\n  let fileName = escapeFileName(name || new Date().toISOString());\n  return fileName + (extension || '');\n}\n\nfunction escapeFileName(str) {\n  if (!str) return '';\n\n  return str.replace(/[#%&{}\\\\/?*><$!'\":@+`|=]/g, '_');\n}\n\n\nfunction drawTextLabel(element, ctx) {\n  if (!element) return Promise.resolve();\n\n  return new Promise((resolve, reject) => {\n    let dpr = window.devicePixelRatio || 1;\n\n    if (element.element instanceof SVGSVGElement) {\n      let svg = element.element;\n      let rect = element.bounds;\n      let image = new Image();\n      image.width = rect.width * dpr;\n      image.height = rect.height * dpr;\n      image.onload = () => {\n        ctx.drawImage(image, rect.left * dpr, rect.top * dpr, image.width, image.height);\n        svg.removeAttribute('width');\n        svg.removeAttribute('height');\n        resolve();\n      };\n\n      // Need to set width, otherwise firefox doesn't work: https://stackoverflow.com/questions/28690643/firefox-error-rendering-an-svg-image-to-html5-canvas-with-drawimage\n      svg.setAttribute('width', image.width);\n      svg.setAttribute('height', image.height);\n      image.src = 'data:image/svg+xml;base64,' + btoa(new XMLSerializer().serializeToString(svg));\n    } else {\n      ctx.save();\n\n      ctx.font = dpr * element.fontSize + 'px ' + element.fontFamily;\n      ctx.fillStyle = element.color;\n      ctx.textAlign = 'end'\n      ctx.fillText(\n        element.text, \n        (element.bounds.right - element.paddingRight) * dpr, \n        (element.bounds.bottom - element.paddingBottom) * dpr\n      )\n      ctx.restore();\n      resolve();\n    }\n  });\n}\n\nfunction collectPrintable() {\n  return Array.from(document.querySelectorAll('.printable')).map(element => {\n    let computedStyle = window.getComputedStyle(element);\n    let bounds = element.getBoundingClientRect();\n    let fontSize = Number.parseInt(computedStyle.fontSize, 10);\n    let paddingRight = Number.parseInt(computedStyle.paddingRight, 10);\n    // TODO: I don't know why I need to multiply by 2, it's just\n    // not aligned right if I don't multiply. Need to figure out this.\n    let paddingBottom = Number.parseInt(computedStyle.paddingBottom, 10) * 2;\n\n    return {\n      text: element.innerText,\n      bounds,\n      fontSize,\n      paddingBottom,\n      paddingRight,\n      color: computedStyle.color,\n      fontFamily: computedStyle.fontFamily,\n      fill: computedStyle.color,\n      element\n    }\n  });\n}\n\nfunction revokeLater(url) {\n  // In iOS immediately revoked URLs cause \"WebKitBlobResource error 1.\" error\n  // Setting a timeout to revoke URL in the future fixes the error:\n  setTimeout(() => {\n    window.URL.revokeObjectURL(url);\n  }, 45000);\n}\n\nfunction toProtobuf() {\n  if (!lastGrid) return;\n\n  let arrayBuffer = protobufExport(lastGrid);\n  let blob = new Blob([arrayBuffer.buffer], {type: \"application/octet-stream\"});\n  let url = window.URL.createObjectURL(blob);\n  let a = document.createElement(\"a\");\n  a.href = url;\n  a.download = lastGrid.id + '.pbf';\n  a.click();\n  revokeLater(url);\n}\n","import bus from './bus';\nimport GridLayer from './GridLayer';\nimport Query from './Query';\nimport LoadOptions from './LoadOptions.js';\nimport config from '../config';\nimport tinycolor from 'tinycolor2';\nimport eventify from 'ngraph.events';\nimport {toSVG, toPNG} from './saveFile';\n\nconst wgl = require('w-gl');\n/**\n * This file is responsible for rendering of the grid. It uses my silly 2d webgl\n * renderer which is not very well documented, neither popular, yet it is very\n * fast.\n */\n\nexport default function createScene(canvas) {\n  let scene = wgl.createScene(canvas);\n  let lastLineColor = config.getDefaultLineColor();\n  scene.on('transform', triggerTransform);\n  scene.on('append-child', triggerAdd);\n  scene.on('remove-child', triggerRemove);\n\n  scene.setClearColor(0xf7/0xff, 0xf2/0xff, 0xe8/0xff, 1.0);\n  let camera = scene.getCamera();\n  if (camera.setMoveSpeed) {\n    camera.setMoveSpeed(200);\n    camera.setRotationSpeed(Math.PI/500);\n  }\n\n  let gl = scene.getGL();\n  gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n  let slowDownZoom = false;\n  let layers = [];\n  let backgroundColor = config.getBackgroundColor();\n\n  listenToEvents();\n\n  let sceneAPI = {\n    /**\n     * Requests the scene to perform immediate re-render\n     */\n    render() {\n      scene.renderFrame(true);\n    },\n\n    /**\n     * Removes all layers in the scene\n     */\n    clear() {\n      layers.forEach(layer => layer.destroy());\n      layers = [];\n      scene.clear();\n    },\n\n    /**\n     * Returns all layers in the scene.\n     */\n    queryLayerAll,\n\n    /**\n     * Same as `queryLayerAll(filter)` but returns the first found\n     * match. If no matches found - returns undefined.\n     */\n    queryLayer,\n    \n    getRenderer() {\n      return scene;\n    },\n\n    getWGL() {\n      // Let the plugins use the same version of wgl library\n      return wgl;\n    },\n\n    version() {\n      return '0.0.2'; // here be dragons\n    },\n\n    /**\n     * Destroys the scene, cleans up all resources.\n     */\n    dispose() {\n      scene.clear();\n      scene.dispose();\n      sceneAPI.fire('dispose', sceneAPI);\n      unsubscribeFromEvents();\n    },\n\n    /**\n     * Uniformly sets color to all loaded grid layer.\n     */\n    set lineColor(color) {\n      layers.forEach(layer => {\n        layer.color = color;\n      });\n      lastLineColor = tinycolor(color);\n      bus.fire('line-color', lastLineColor);\n      sceneAPI.fire('line-color', lastLineColor);\n    },\n\n    get lineColor() {\n      let firstLayer = queryLayer();\n      return (firstLayer && firstLayer.color) || lastLineColor;\n    },\n\n    /**\n     * Sets the background color of the scene\n     */\n    set background(rawColor) {\n      backgroundColor = tinycolor(rawColor);\n      let c = backgroundColor.toRgb();\n      scene.setClearColor(c.r/0xff, c.g/0xff, c.b/0xff, c.a);\n      scene.renderFrame();\n      bus.fire('background-color', backgroundColor);\n      sceneAPI.fire('background-color', backgroundColor);\n    },\n\n    get background() {\n      return backgroundColor;\n    },\n\n    add,\n\n    /**\n     * Executes an OverPass query and loads results into scene.\n     */\n    load,\n\n    saveToPNG,\n\n    saveToSVG\n  };\n\n  return eventify(sceneAPI); // Public bit is over. Below are just implementation details.\n\n  /**\n   * Experimental API. Can be changed/removed at any point.\n   */\n  function load(queryFilter, rawOptions) {\n    let options = LoadOptions.parse(sceneAPI, queryFilter, rawOptions);\n\n    let layer = new GridLayer();\n    layer.id = options.place;\n\n    // TODO: Cancellation logic?\n    Query.runFromOptions(options).then(grid => {\n      grid.setProjector(options.projector);\n      layer.setGrid(grid);\n    }).catch(e => {\n      console.error(`Could not execute:\n  ${queryFilter}\n  The error was:`);\n      console.error(e);\n      layer.destroy();\n    });\n  \n    add(layer);\n    return layer;\n  }\n\n  function queryLayerAll(filter) {\n    if (!filter) return layers;\n\n    return layers.filter(layer => {\n      return layer.id === filter;\n    });\n  }\n\n  function queryLayer(filter) {\n    let result = queryLayerAll(filter);\n    if (result) return result[0];\n  }\n\n  function add(gridLayer) {\n    if (layers.indexOf(gridLayer) > -1) return; // O(n).\n\n    gridLayer.bindToScene(scene);\n    layers.push(gridLayer);\n\n    if (layers.length === 1) {\n      // TODO: Should I do this for other layers?\n      let viewBox = gridLayer.getViewBox();\n      if (viewBox) {\n        scene.setViewBox(viewBox);\n      }\n    }\n  }\n\n  function saveToPNG(name) {\n    return toPNG(sceneAPI, {name});\n  }\n\n  function saveToSVG(name, options) {\n    return toSVG(sceneAPI, Object.assign({}, {name}, options));\n  }\n\n  function triggerTransform(t) {\n    bus.fire('scene-transform');\n  }\n\n  function triggerAdd(e) {\n    sceneAPI.fire('layer-added', e);\n  }\n\n  function triggerRemove(e) {\n    sceneAPI.fire('layer-removed', e);\n  }\n\n  function listenToEvents() {\n    document.addEventListener('keydown', onKeyDown, true);\n    document.addEventListener('keyup', onKeyUp, true);\n  }\n\n  function unsubscribeFromEvents() {\n    document.removeEventListener('keydown', onKeyDown, true);\n    document.removeEventListener('keyup', onKeyUp, true);\n  }\n\n  function onKeyDown(e) {\n    if (e.shiftKey) {\n      slowDownZoom = true;\n      if (camera.setSpeed) camera.setSpeed(0.1);\n    } \n  }\n\n  function onKeyUp(e) {\n    if (!e.shiftKey && slowDownZoom) {\n      if (camera.setSpeed) camera.setSpeed(1);\n      slowDownZoom = false;\n    }\n  }\n}","import request from './request';\nimport Progress from './Progress';\n\nlet imageUrl = 'https://edi6jgnosf.execute-api.us-west-2.amazonaws.com/Stage/put_image'\n\nconst productKinds = {\n  mug: '168739066664861503'\n};\n\nfunction getZazzleLink(kind, imageUrl) {\n  const productCode = productKinds[kind];\n  if (!productCode) {\n    throw new Error('Unknown product kind: ' + kind);\n  }\n\n  const imageEncoded = encodeURIComponent(imageUrl);\n  return `https://www.zazzle.com/api/create/at-238058511445368984?rf=238058511445368984&ax=Linkover&pd=${productCode}&ed=true&tc=&ic=&t_map_iid=${imageEncoded}`;\n}\n\nexport default function generateZazzleLink(canvas) {\n  var imageContent = canvas.toDataURL('image/png').replace(/^data:image\\/(png|jpg);base64,/, '');\n  const form = new FormData();\n  form.append('image', imageContent);\n\n  return request(imageUrl, {\n    method: 'POST',\n    responseType: 'json',\n    progress: new Progress(Function.prototype),\n    body: form,\n  }, 'POST').then(x => {\n    if (!x.success) throw new Error('Failed to upload image');\n    let link = x.data.link; \n    return getZazzleLink('mug', link);\n  }).catch(e => {\n    console.log('error', e);\n    throw e;\n  });\n}","export default function createOverlayManager() {\n  let overlay;\n  let downEvent = {\n    clickedElement: null,\n    x: 0,\n    y: 0,\n    time: Date.now(),\n    left: 0,\n    right: 0\n  };\n\n  document.addEventListener('mousedown', handleMouseDown);\n  document.addEventListener('mouseup', handleMouseUp);\n  document.addEventListener('touchstart', handleTouchStart, {passive: false, capture: true});\n  document.addEventListener('touchend', handleTouchEnd, true);\n  document.addEventListener('touchcancel', handleTouchEnd, true);\n\n  return {\n    track,\n    dispose,\n    clear\n  }\n\n  function clear() {\n    const activeOverlays = document.querySelectorAll('.overlay-active');\n    for (let i = 0; i < activeOverlays.length; ++i) {\n      deselect(activeOverlays[i]);\n    }\n  }\n\n  function handleMouseDown(e) {\n    onPointerDown(e.clientX, e.clientY, e);\n  }\n\n  function handleMouseMove(e) {\n    onPointerMove(e.clientX, e.clientY);\n  }\n\n  function handleMouseUp(e) {\n    onPointerUp(e.clientX, e.clientY)\n  }\n\n  function handleTouchStart(e) {\n    if (e.touches.length > 1) return;\n\n    let touch = e.touches[0];\n    onPointerDown(touch.clientX, touch.clientY, e);\n  }\n\n  function handleTouchEnd(e) {\n    if (e.changedTouches.length > 1) return;\n    let touch = e.changedTouches[0];\n    let gotSomethingSelected = onPointerUp(touch.clientX, touch.clientY);\n    if (gotSomethingSelected) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  function handleTouchMove(e) {\n    if (e.touches.length > 1) return;\n    let touch = e.touches[0];\n    onPointerMove(touch.clientX, touch.clientY);\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  function onPointerDown(x, y, e) {\n    let foundElement = findTrackedElementUnderCursor(x, y)\n    let activeOverlays = document.querySelectorAll('.overlay-active');\n\n    for (let i = 0; i < activeOverlays.length; ++i) {\n      let el = activeOverlays[i];\n      if (el !== foundElement) deselect(el);\n    }\n    if (activeOverlays.length === 1) downEvent.clickedElement = activeOverlays[0];\n\n    let secondTimeClicking = foundElement && foundElement === downEvent.clickedElement;\n    if (secondTimeClicking) {\n      if (!downEvent.clickedElement.contains(e.target)) {\n        foundElement = null;\n        secondTimeClicking = false;\n      }\n    }\n    let shouldAddOverlay = secondTimeClicking && !foundElement.classList.contains('exclusive');\n    if (shouldAddOverlay) {\n      // prepare for move!\n      addDragOverlay();\n      e.preventDefault();\n      e.stopPropagation();\n    } else {\n      downEvent.clickedElement = foundElement;\n    }\n\n    downEvent.x = x;\n    downEvent.y = y;\n    downEvent.time = Date.now();\n    if (foundElement) {\n      let bBox = foundElement.getBoundingClientRect();\n      downEvent.dx = bBox.right - downEvent.x; \n      downEvent.dy = bBox.bottom - downEvent.y;\n    } else {\n      clear();\n    }\n  }\n\n  function onPointerUp(x, y) {\n    if (!downEvent.clickedElement) return;\n    removeOverlay();\n\n    if (isSingleClick(x, y)) {\n      // forward focus, we didn't move the element\n      select(downEvent.clickedElement, x, y);\n      return true;\n    } else {\n      downEvent.clickedElement = null;\n    }\n  }\n\n  function onPointerMove(x, y) {\n    if (!downEvent.clickedElement) return;\n\n    let style = downEvent.clickedElement.style;\n    style.right = 100*(window.innerWidth - x - downEvent.dx)/window.innerWidth + '%';\n    style.bottom = 100*(window.innerHeight - y - downEvent.dy)/window.innerHeight + '%';\n  }\n\n  function addDragOverlay() {\n    removeOverlay();\n\n    overlay = document.createElement('div');\n    overlay.classList.add('drag-overlay');\n    document.body.appendChild(overlay);\n\n    document.addEventListener('mousemove', handleMouseMove, true);\n    document.addEventListener('touchmove', handleTouchMove, {passive: false, capture: true});\n  }\n\n  function removeOverlay() {\n    if (overlay) {\n      document.body.removeChild(overlay);\n      overlay = null;\n    }\n\n    document.removeEventListener('mousemove', handleMouseMove, true);\n    document.removeEventListener('touchmove', handleTouchMove, {passive: false, capture: true});\n  }\n\n  function isSingleClick(x, y) {\n    let timeDiff = Date.now() - downEvent.time;\n    if (timeDiff > 300) return false; // took too long for a single click;\n\n    // should release roughly in the same place where pressed:\n    return Math.hypot(x - downEvent.x, y - downEvent.y) < 40; \n  }\n\n  function findTrackedElementUnderCursor(x, y) {\n    let autoTrack = document.querySelectorAll('.can-drag');\n    for (let i = 0; i < autoTrack.length; ++i) {\n      let el = autoTrack[i];\n      let rect = getRectangle(el);\n      if (intersects(x, y, rect)) return el;\n    }\n  }\n\n  function deselect(el) {\n    el.style.pointerEvents = 'none';\n    el.classList.remove('overlay-active');\n    el.classList.remove('exclusive')\n  }\n\n  function select(el, x, y) {\n    if (!el) return;\n\n    el.style.pointerEvents = '';\n\n    if (el.classList.contains('overlay-active')) {\n      // When they click second time, we want to forward focus to the element\n      // (if they support focus forwarding)\n      if (el.receiveFocus) el.receiveFocus();\n      // and make the element exclusive owner of the mouse/pointer\n      // (so that native interaction can occur and we don't interfere with dragging)\n      el.classList.add('exclusive')\n    } else {\n      // When they click first time, we enter to \"drag around\" mode\n      el.classList.add('overlay-active');\n      if (el.classList.contains('can-resize')) {\n        // el.resizer = renderResizeHandlers(el);\n      }\n    }\n  }\n\n\n  function intersects(x, y, rect) {\n    return !(x < rect.left || x > rect.right || y < rect.top || y > rect.bottom);\n  }\n\n  function getRectangle(x) {\n    return x.getBoundingClientRect();\n  }\n\n  function track(domElement, options) {\n    domElement.style.pointerEvents = 'none'\n    domElement.classList.add('can-drag');\n\n    if (options) {\n      if (options.receiveFocus) domElement.receiveFocus = options.receiveFocus;\n    }\n  }\n\n  function dispose() {\n    document.removeEventListener('mousedown', handleMouseDown);\n    document.removeEventListener('mouseup', handleMouseUp);\n    document.removeEventListener('touchstart', handleTouchStart);\n    document.removeEventListener('touchend', handleTouchEnd);\n    document.removeEventListener('touchcancel', handleTouchEnd);\n    downEvent.clickedElement = undefined;\n    removeOverlay();\n  }\n}\n\nfunction renderResizeHandlers(el) {\n  el.getBoundingClientRect(el)\n}","<template>\n<div>\n  <find-place v-if='!placeFound' @loaded='onGridLoaded'></find-place>\n  <div id=\"app\">\n    <div v-if='placeFound'>\n      <div class='controls'>\n        <a href=\"#\" class='print-button' @click.prevent='toggleSettings'>Customize...</a>\n        <a href=\"#\" class='try-another' @click.prevent='startOver'>Try another city</a>\n      </div>\n      <div v-if='showSettings' class='print-window'>\n        <h3>Display</h3>\n        <div class='row'>\n          <div class='col'>Colors</div>\n          <div class='col colors c-2'>\n            <div v-for='layer in layers' :key='layer.name' class='color-container'>\n              <color-picker v-model='layer.color' @change='layer.changeColor'></color-picker>\n              <div class='color-label'>{{layer.name}}</div>\n            </div>\n          </div>\n        </div>\n\n        <h3>Export</h3>\n        <div class='row'>\n          <a href='#' @click.prevent='zazzleMugPrint()' class='col'>Onto a mug</a> \n          <span class='col c-2'>\n            Print what you see onto a mug. <br/>Get a unique gift of your favorite city.\n          </span>\n        </div>\n        <div class='preview-actions message' v-if='zazzleLink || generatingPreview'>\n            <div v-if='zazzleLink' class='padded popup-help'>\n              If your browser has blocked the new window, <br/>please <a :href='zazzleLink' target='_blank'>click here</a>\n              to open it.\n            </div>\n            <div v-if='generatingPreview' class='loading-container'>\n              <loading-icon></loading-icon>\n              Generating preview url...\n            </div>\n        </div>\n        <div class='row'>\n          <a href='#'  @click.prevent='toPNGFile' class='col'>As an image (.png)</a> \n          <span class='col c-2'>\n            Save the current screen as a raster image.\n          </span>\n        </div>\n        \n        <div class='row'>\n          <a href='#'  @click.prevent='toSVGFile' class='col'>As a vector (.svg)</a> \n          <span class='col c-2'>\n            Save the current screen as a vector image.\n          </span>\n        </div>\n        <div v-if='false' class='row'>\n          <a href='#' @click.prevent='toProtobuf' class='col'>To a .PBF file</a> \n          <span class='col c-2'>\n            Save the current data as a protobuf message. For developer use only.\n          </span>\n        </div>\n\n        <h3>About</h3>\n        <div>\n          <p>This website was created by <a href='https://twitter.com/anvaka' target='_blank'>@anvaka</a>.\n          It downloads roads from OpenStreetMap and renders them with WebGL.\n          </p>\n          <p>\n           You can find the entire <a href='https://github.com/anvaka/city-roads'>source code here</a>. \n           If you love this website you can also <a href='https://www.paypal.com/paypalme2/anvakos/3'>buy me a coffee</a> or \n           <a href='https://www.patreon.com/anvaka'>support me on Patreon</a>, but you don't have to.\n          </p>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <editable-label v-if='placeFound' v-model='name' class='city-name' :printable='true' :style='{color: labelColorRGBA}' :overlay-manager='overlayManager'></editable-label>\n  <div v-if='placeFound' class='license printable can-drag' :style='{color: labelColorRGBA}'>data <a href='https://www.openstreetmap.org/about/' target=\"_blank\" :style='{color: labelColorRGBA}'>© OpenStreetMap</a></div>\n  </div>\n</template>\n\n<script>\nimport FindPlace from './components/FindPlace';\nimport LoadingIcon from './components/LoadingIcon';\nimport EditableLabel from './components/EditableLabel';\nimport ColorPicker from './components/ColorPicker';\nimport createScene from './lib/createScene';\nimport GridLayer from './lib/GridLayer';\nimport generateZazzleLink from './lib/getZazzleLink';\nimport appState from './lib/appState';\nimport {getPrintableCanvas, getCanvas} from './lib/saveFile';\nimport config from './config';\nimport './lib/canvas2BlobPolyfill';\nimport bus from './lib/bus';\nimport createOverlayManager from './createOverlayManager';\nimport tinycolor from 'tinycolor2';\n\nclass ColorLayer {\n  constructor(name, color, callback) {\n    this.name = name;\n    this.changeColor = callback;\n    this.color = color;\n  }\n}\n\nexport default {\n  name: 'App',\n  components: {\n    FindPlace,\n    LoadingIcon,\n    EditableLabel,\n    ColorPicker\n  },\n  data() {\n    return {\n      placeFound: false,\n      name: '',\n      zazzleLink: null,\n      generatingPreview: false,\n      showSettings: false,\n      settingsOpen: false,\n      labelColor: config.getLabelColor().toRgb(),\n      backgroundColor: config.getBackgroundColor().toRgb(),\n      layers: []\n    }\n  },\n  computed: {\n    labelColorRGBA() {\n      return toRGBA(this.labelColor);\n    }\n  },\n  created() {\n    bus.on('scene-transform', this.handleSceneTransform);\n    bus.on('background-color', this.syncBackground);\n    bus.on('line-color', this.syncLineColor);\n    this.overlayManager = createOverlayManager();\n  },\n  beforeDestroy() {\n    this.overlayManager.dispose();\n    this.dispose();\n    bus.off('scene-transform', this.handleSceneTransform);\n    bus.off('background-color', this.syncBackground);\n    bus.off('line-color', this.syncLineColor);\n  },\n  methods: {\n    dispose() {\n      if (this.scene) {\n        this.scene.dispose();\n        window.scene = null;\n      }\n    },\n    toggleSettings() {\n      this.showSettings = !this.showSettings;\n    },\n    handleSceneTransform() {\n      this.zazzleLink = null;\n    },\n    onGridLoaded(grid) {\n      if (grid.isArea) {\n        appState.set('areaId', grid.id);\n        appState.unset('osm_id');\n        appState.unset('bbox');\n      } else if (grid.bboxString) {\n        appState.unset('areaId');\n        appState.set('osm_id', grid.id);\n        appState.set('bbox', grid.bboxString);\n      }\n      this.placeFound = true;\n      this.name = grid.name.split(',')[0];\n      let canvas = getCanvas();\n      canvas.style.visibility = 'visible';\n\n      this.scene = createScene(canvas);\n      this.scene.on('layer-added', this.updateLayers);\n      this.scene.on('layer-removed', this.updateLayers);\n\n      window.scene = this.scene;\n\n      let gridLayer = new GridLayer();\n      gridLayer.id = 'lines';\n      gridLayer.setGrid(grid);\n      this.scene.add(gridLayer)\n    },\n\n    startOver() {\n      appState.unset('areaId');\n      appState.unsetPlace();\n      appState.unset('q');\n      appState.enableCache();\n\n      this.dispose();\n      this.placeFound = false;\n      this.zazzleLink = null;\n      this.showSettings = false;\n      this.backgroundColor = config.getBackgroundColor().toRgb();\n      this.labelColor = config.getLabelColor().toRgb();\n\n      document.body.style.backgroundColor = config.getBackgroundColor().toRgbString();\n      getCanvas().style.visibility = 'hidden';\n    },\n\n    toPNGFile(e) {\n      scene.saveToPNG(this.name)\n    },\n\n    toSVGFile(e) { \n      scene.saveToSVG(this.name)\n    },\n\n    updateLayers() {\n      // TODO: This method likely doesn't belong here\n      let newLayers = [];\n      let lastLayer = 0;\n      let renderer = this.scene.getRenderer();\n      let root = renderer.getRoot();\n      root.children.forEach(layer => {\n        if (!layer.color) return;\n        let name = layer.id;\n        if (!name) {\n          lastLayer += 1;\n          name = 'lines ' + lastLayer;\n        }\n        let layerColor = tinycolor.fromRatio(layer.color);\n        newLayers.push(new ColorLayer(name, layerColor, newColor => {\n          this.zazzleLink = null;\n          layer.color = toRatioColor(newColor);\n          renderer.renderFrame();\n          this.scene.fire('color-change', layer);\n        }));\n      });\n\n      newLayers.push(\n        new ColorLayer('background', this.backgroundColor, this.setBackgroundColor),\n        new ColorLayer('labels', this.labelColor, newColor => this.labelColor = newColor)\n      );\n\n      this.layers = newLayers;\n\n      function toRatioColor(c) {\n        return {r: c.r/0xff, g: c.g/0xff, b: c.b/0xff, a: c.a}\n      }\n      this.zazzleLink = null;\n    },\n\n    syncLineColor() {\n      this.updateLayers();\n    },\n\n    syncBackground(newBackground) {\n      this.backgroundColor = newBackground.toRgb();\n      this.updateLayers()\n    },\n    // TODO: I need two background methods?\n    updateBackground() {\n      this.setBackgroundColor(this.backgroundColor)\n      this.zazzleLink = null;\n    },\n    setBackgroundColor(c) {\n      this.scene.background = c;\n      document.body.style.backgroundColor = toRGBA(c);\n      this.zazzleLink = null;\n    },\n\n    zazzleMugPrint() {\n      if (this.zazzleLink) {\n        window.open(this.zazzleLink, '_blank');\n        recordOpenClick(this.zazzleLink);\n        return;\n      }\n\n      this.generatingPreview = true;\n      getPrintableCanvas(this.scene).then(printableCanvas => {\n        generateZazzleLink(printableCanvas).then(link => {\n          this.zazzleLink = link;\n          window.open(link, '_blank');\n          recordOpenClick(link);\n          this.generatingPreview = false;\n        }).catch(e => {\n          this.error = e;\n          this.generatingPreview = false;\n        });\n      });\n    }\n  }\n}\n\nfunction toRGBA(c) {\n    return `rgba(${c.r}, ${c.g}, ${c.b}, ${c.a})`;\n}\n\nfunction recordOpenClick(link) {\n  if (typeof ga === 'undefined') return;\n\n  ga('send', 'event', {\n      eventCategory: 'Outbound Link',\n      eventAction: 'click',\n      eventLabel: link\n    });\n}\n</script>\n\n<style lang='stylus'>\n@import('./vars.styl');\n\n#app {\n  margin: 8px;\n  max-height: 100vh;\n  position: absolute;\n  z-index: 1;\n  h3 {\n    font-weight: normal;\n  }\n}\n\n.can-drag {\n  border: 1px solid transparent;\n}\n\n.drag-overlay {\n  position: fixed;\n  background: transparent;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n}\n\n.overlay-active {\n  border: 1px dashed highlight-color;\n}\n.overlay-active.exclusive {\n  border-style: solid;\n}\n\n.controls {\n  height: 48px;\n  background: white;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n  width: desktop-controls-width;\n  justify-content: space-around;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n\n  a {\n    text-decoration: none;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    color: highlight-color;\n    margin: 0;\n    border: 0;\n    &:hover {\n      color: emphasis-background;\n      background: highlight-color;\n    }\n  }\n  a.try-another {\n    flex: 1;\n  }\n\n  a.print-button {\n    flex: 1;\n    border-right: 1px solid border-color;\n    &:focus {\n      border: 1px dashed highlight-color;\n    }\n  }\n}\n\n.col {\n    display: flex;\n    flex: 1;\n    select {\n      margin-left: 14px;\n    }\n  }\n.row {\n  margin-top: 4px;\n  display: flex;\n  flex-direction: row;\n  min-height: 32px;\n}\n.colors {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n\n  .color-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    width: 64px;\n  }\n\n  .color-label {\n    font-size: 12px;\n  }\n}\n\na {\n  border: 1px solid transparent;\n  margin: -1px;\n  text-decoration: none;\n  color: highlight-color\n}\na:focus {\n  border: 1px dashed highlight-color;\n  outline: none;\n}\n.print-window {\n  max-height: calc(100vh - 48px);\n  overflow-y: auto;\n  border-top: 1px solid border-color;\n  background: white;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n  width: desktop-controls-width;\n  padding: 8px;\n  .row a {\n    margin-right: 4px;\n  }\n\n  h3 {\n    margin: 8px 0;\n    text-align: right;\n  }\n}\n\n.message {\n  border-top: 1px solid border-color\n  border-bottom: 1px solid border-color\n  background: #F5F5F5;\n}\n\n.preview-actions {\n  display: flex;\n  padding: 8px 0;\n  margin-left: -8px;\n  margin-bottom: 14px;\n  margin-top: 1px;\n  width: desktop-controls-width;\n  flex-direction: column;\n  align-items: stretch;\n  font-size: 14px;\n  align-items: center;\n  display: flex;\n\n  .popup-help {\n    text-align: center;\n  }\n}\n\n.city-name {\n  position: absolute;\n  right: 32px;\n  bottom: 54px;\n  font-size: 24px;\n  color: #434343;\n  input {\n    font-size: 24px;\n  }\n}\n\n.license {\n  text-align: right;\n  position: fixed;\n  font-family: labels-font;\n  right: 32px;\n  bottom: 32px;\n  font-size: 12px;\n  padding-right: 8px;\n  a {\n    text-decoration: none;\n    display: inline-block;\n  }\n}\n\n.c-2 {\n  flex: 2\n}\n\n@media (max-width: small-screen) {\n  #app {\n    width: 100%;\n    margin: 0;\n\n    .preview-actions,.error,\n    .controls, .print-window {\n      width: 100%;\n    }\n    .loading-container {\n      font-size: 12px;\n    }\n\n    .print-window {\n      font-size: 14px;\n    }\n\n  }\n  .city-name  {\n    right: 8px;\n    bottom: 24px;\n  }\n  .license  {\n    right: 8px;\n    bottom: 8px;\n  }\n}\n\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=f593488e&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"absolute no-webgl\"},[_c('h3',[_vm._v(\"WebGL is not enabled :(\")]),_c('p',[_vm._v(\"This website renders millions of roads at once.\")]),_c('p',[_vm._v(\" To render this amount of data fast, the website uses \"),_c('a',{attrs:{\"href\":\"https://get.webgl.org/\"}},[_vm._v(\"WebGL\")]),_vm._v(\", which seem to be not supported by the device that you are using. \")]),_c('p',[_vm._v(\"Please try a different device to play with this website\")]),_c('img',{attrs:{\"src\":\"https://i.imgur.com/Fbbe5a6.png\",\"alt\":\"demo\"}})])}]\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./NoWebGL.vue?vue&type=template&id=3c40a512&scoped=true&\"\nvar script = {}\nimport style0 from \"./NoWebGL.vue?vue&type=style&index=0&id=3c40a512&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3c40a512\",\n  null\n  \n)\n\nexport default component.exports","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue';\nimport App from './App';\nimport NoWebGL from './NoWebGL';\nimport Query from './lib/Query';\nimport {require as d3Require} from 'd3-require';\n\nconst wgl = require('w-gl');\n\nwindow.addEventListener('error', logError);\n\nVue.config.productionTip = false\n\n// expose the console API\nwindow.requireModule = d3Require;\nwindow.Query = Query;\n\nif (wgl.isWebGLEnabled(document.querySelector('#canvas'))) {\n  /* eslint-disable no-new */\n  new Vue({\n    render: h => h(App),\n  }).$mount('#app')\n} else {\n\n  new Vue({\n    render: h => h(NoWebGL),\n  }).$mount('#app')\n}\n\nfunction logError(e) {\n  if (typeof ga !== 'function') return;\n\n  const exDescription = e ? `${e.message} in ${e.filename}:${e.lineno}` : 'Unknown exception';\n\n  ga('send', 'exception', {\n    exDescription,\n    exFatal: false\n  });\n}","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=stylus&\"","var Pbf = require('pbf');\nvar place = require('../proto/place.js').place;\n\nmodule.exports = function protoBufExport(grid) {\n  let nodes = [];\n  let ways = [];\n  let date = (new Date()).toISOString();\n\n  grid.forEachElement(x => {\n    let elementType = 0;\n    if (x.type === 'node') {\n      nodes.push(x)\n    } else if (x.type === 'way') {\n      ways.push(x)\n    }\n  });\n\n  let pbf = new Pbf()\n  place.write({\n    version: 1,\n    id: grid.id,\n    date, \n    name: grid.name,\n    nodes, ways\n  }, pbf);\n  return pbf.finish();\n}","/*\n * JavaScript Canvas to Blob\n * https://github.com/blueimp/JavaScript-Canvas-to-Blob\n *\n * Copyright 2012, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on stackoverflow user Stoive's code snippet:\n * http://stackoverflow.com/q/4998908\n */\n\n/* global define, Uint8Array, ArrayBuffer, module */\n\n;(function(window) {\n  'use strict'\n\n  var CanvasPrototype =\n    window.HTMLCanvasElement && window.HTMLCanvasElement.prototype\n  var hasBlobConstructor =\n    window.Blob &&\n    (function() {\n      try {\n        return Boolean(new Blob())\n      } catch (e) {\n        return false\n      }\n    })()\n  var hasArrayBufferViewSupport =\n    hasBlobConstructor &&\n    window.Uint8Array &&\n    (function() {\n      try {\n        return new Blob([new Uint8Array(100)]).size === 100\n      } catch (e) {\n        return false\n      }\n    })()\n  var BlobBuilder =\n    window.BlobBuilder ||\n    window.WebKitBlobBuilder ||\n    window.MozBlobBuilder ||\n    window.MSBlobBuilder\n  var dataURIPattern = /^data:((.*?)(;charset=.*?)?)(;base64)?,/\n  var dataURLtoBlob =\n    (hasBlobConstructor || BlobBuilder) &&\n    window.atob &&\n    window.ArrayBuffer &&\n    window.Uint8Array &&\n    function(dataURI) {\n      var matches,\n        mediaType,\n        isBase64,\n        dataString,\n        byteString,\n        arrayBuffer,\n        intArray,\n        i,\n        bb\n      // Parse the dataURI components as per RFC 2397\n      matches = dataURI.match(dataURIPattern)\n      if (!matches) {\n        throw new Error('invalid data URI')\n      }\n      // Default to text/plain;charset=US-ASCII\n      mediaType = matches[2]\n        ? matches[1]\n        : 'text/plain' + (matches[3] || ';charset=US-ASCII')\n      isBase64 = !!matches[4]\n      dataString = dataURI.slice(matches[0].length)\n      if (isBase64) {\n        // Convert base64 to raw binary data held in a string:\n        byteString = atob(dataString)\n      } else {\n        // Convert base64/URLEncoded data component to raw binary:\n        byteString = decodeURIComponent(dataString)\n      }\n      // Write the bytes of the string to an ArrayBuffer:\n      arrayBuffer = new ArrayBuffer(byteString.length)\n      intArray = new Uint8Array(arrayBuffer)\n      for (i = 0; i < byteString.length; i += 1) {\n        intArray[i] = byteString.charCodeAt(i)\n      }\n      // Write the ArrayBuffer (or ArrayBufferView) to a blob:\n      if (hasBlobConstructor) {\n        return new Blob([hasArrayBufferViewSupport ? intArray : arrayBuffer], {\n          type: mediaType\n        })\n      }\n      bb = new BlobBuilder()\n      bb.append(arrayBuffer)\n      return bb.getBlob(mediaType)\n    }\n  if (window.HTMLCanvasElement && !CanvasPrototype.toBlob) {\n    if (CanvasPrototype.mozGetAsFile) {\n      CanvasPrototype.toBlob = function(callback, type, quality) {\n        var self = this\n        setTimeout(function() {\n          if (quality && CanvasPrototype.toDataURL && dataURLtoBlob) {\n            callback(dataURLtoBlob(self.toDataURL(type, quality)))\n          } else {\n            callback(self.mozGetAsFile('blob', type))\n          }\n        })\n      }\n    } else if (CanvasPrototype.toDataURL && dataURLtoBlob) {\n      CanvasPrototype.toBlob = function(callback, type, quality) {\n        var self = this\n        setTimeout(function() {\n          callback(dataURLtoBlob(self.toDataURL(type, quality)))\n        })\n      }\n    }\n  }\n  if (typeof define === 'function' && define.amd) {\n    define(function() {\n      return dataURLtoBlob\n    })\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = dataURLtoBlob\n  } else {\n    window.dataURLtoBlob = dataURLtoBlob\n  }\n})(window)","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditableLabel.vue?vue&type=style&index=0&lang=stylus&\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./NoWebGL.vue?vue&type=style&index=0&id=3c40a512&lang=stylus&scoped=true&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=style&index=0&id=a5fc1b7c&lang=stylus&scoped=true&\""],"sourceRoot":""}